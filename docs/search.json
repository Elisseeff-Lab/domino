[{"path":"/articles/domino2.html","id":"using-domino2-v0-2-1-for-cell-cell-communication-inference","dir":"Articles","previous_headings":"","what":"Using Domino2 v0.2.1 for cell-cell communication inference","title":"Get Started","text":"Domino2 tool analysis intra- intercellular signaling single cell RNA sequencing data based transcription factor activation. , show basic example pipeline generating communication networks domino object using single cell RNA sequencing(scRNAseq) data. vignette demonstrate use Domino2 10X Genomics Peripheral Blood Mononuclear Cells (PBMC) data set 2,700 cells. data can downloaded .","code":""},{"path":"/articles/domino2.html","id":"preprocessing-scrnaseq-data","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference","what":"Preprocessing scRNAseq data","title":"Get Started","text":"Analysis cell-cell communication Domino2 often follows initial processing annotation scRNAseq data. following Satija Lab’s Guided Clustering Tutorial prepare data set analysis Domino2.","code":"# Preprocessing of PBMC 3K tutorial data set pbmc.data <- Read10X(data.dir = \"../data/pbmc3k_filtered_gene_bc_matrices\") pbmc <- CreateSeuratObject(counts = pbmc.data, project = \"pbmc3k\", min.cells = 3, min.features = 200) pbmc[[\"percent.mt\"]] <- PercentageFeatureSet(pbmc, pattern = \"^MT-\") pbmc <- NormalizeData(pbmc, normalization.method = \"LogNormalize\", scale.factor = 10000) pbmc <- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000) pbmc <- ScaleData(pbmc, features = rownames(pbmc)) pbmc <- RunPCA(pbmc, features = VariableFeatures(object = pbmc)) pbmc <- FindNeighbors(pbmc, dims = 1:10) pbmc <- FindClusters(pbmc, resolution = 0.5) pbmc <- RunUMAP(pbmc, dims = 1:10) # Annotate clusters with cell phenotypes cell_dict <- data.frame(   cluster = c(0:8),   cell_type = c(\"naive_CD4_T_cell\", \"CD14_monocyte\", \"memory_CD4_T_cell\", \"B_cell\", \"CD8_T_cell\", \"CD16_monocyte\", \"NK_cell\", \"dendritic_cell\", \"platelet\") ) pbmc$cell_type <-    plyr::mapvalues(     pbmc$seurat_clusters,     from = cell_dict$cluster,     to = cell_dict$cell_type   )"},{"path":"/articles/domino2.html","id":"saving-preprocessed-data","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Preprocessing scRNAseq data","what":"Saving Preprocessed Data:","title":"Get Started","text":"Domino2 designed compatible Seurat objects addition accepting matrices vectors data set function inputs. Therefore, ’s good idea save processed Seurat object analysis. However, pySCENIC used transcription factor activation inference, requires input cell gene matrix. opposite orientation Seurat objects default Python based tools scanpy. Saving data loom file using loomR helpful step therefore recommended well. cell x gene counts matrix may also saved tab-separated value (.tsv) file loomR used computing resource, aware dense formatting .tsv can lead large file sizes slow processing large data sets. provided necessary code , due large file size, .tsv file provided data directory. like skip ahead rest analysis, processed objects steps available data directory package.","code":"# save Seurat object as RDS saveRDS(pbmc, file = \"../data/pbmc3k_seurat.rds\")  # save loom counts matrix pbmc_counts <- pbmc@assays$RNA@counts pbmc_loom <- loomR::create(filename = \"../data/pbmc3k_counts.loom\", data = pbmc_counts) pbmc_loom$close_all() # Remember to manually close connection to loom files! pbmc_counts <- pbmc@assays$RNA@counts write.table(t(as.matrix(pbmc_counts)), \"../data/pbmc3k_counts.tsv\",      sep = \"\\t\", col.names = NA)"},{"path":"/articles/domino2.html","id":"installation","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference","what":"Installation","title":"Get Started","text":"Installation {domino2} github can achieved using remotes package. current stable version v0.2.1, install branch.","code":"if(!require(remotes)){     install.packages('remotes') } remotes::install_github('FertigLab/domino_development@v0.2.1')"},{"path":"/articles/domino2.html","id":"additional-downloads","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Installation","what":"Additional Downloads","title":"Get Started","text":"tutorial, pySCENIC used method transcription factor activity inference assessment ligand-receptor interactions based curated interactions CellPhoneDB v4.0.0. requires downloading files prior use analysis pipeline.","code":""},{"path":"/articles/domino2.html","id":"downloads-for-scenic","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Installation > Additional Downloads","what":"Downloads for SCENIC:","title":"Get Started","text":"singularity image SCENIC v0.12.1 can installed DockerHub image source (example scripts use Docker provided scenic_bash directory well). SCENIC requires list transcription factors, motif annotations, cisTarget motifs available authors SCENIC human (HGNC), mouse (MGI), fly. following download everything necessary analysis data set HGNC gene labels hg38 genome.","code":"SCENIC_DIR=\"../scenic\" mkdir ${SCENIC_DIR}  # Build singularity image singularity build \"${SCENIC_DIR}/aertslab-pyscenic-0.12.1.sif\" docker://aertslab/pyscenic:0.12.1  # Matrix containing motifs as rows and genes as columns and ranking position for each gene and motif (based on CRM scores) as values # below is a feather v1 format link; feather v2 required for this version of pySCENIC # \"https://resources.aertslab.org/cistarget/databases/old/homo_sapiens/hg38/refseq_r80/mc9nr/gene_based/hg38__refseq-r80__10kb_up_and_down_tss.mc9nr.feather\" # Feather v2 link: curl \"https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg38/refseq_r80/mc_v10_clust/gene_based/hg38_10kbp_up_10kbp_down_full_tx_v10_clust.genes_vs_motifs.rankings.feather\" \\   -o \"${SCENIC_DIR}/hg38_10kbp_up_10kbp_down_full_tx_v10_clust.genes_vs_motifs.rankings.feather\"  # below is a feather v1 format link; feather v2 required for this version of pySCENIC # \"https://resources.aertslab.org/cistarget/databases/old/homo_sapiens/hg38/refseq_r80/mc9nr/gene_based/hg38__refseq-r80__500bp_up_and_100bp_down_tss.mc9nr.feather\" # Feather v2 link: curl \"https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg38/refseq_r80/mc_v10_clust/gene_based/hg38_500bp_up_100bp_down_full_tx_v10_clust.genes_vs_motifs.rankings.feather\" \\   -o \"${SCENIC_DIR}/hg38_500bp_up_100bp_down_full_tx_v10_clust.genes_vs_motifs.rankings.feather\"  # List of genes encoding transcription factors in the HG38 reference genome curl \"https://resources.aertslab.org/cistarget/tf_lists/allTFs_hg38.txt\" \\   -o \"${SCENIC_DIR}/allTFs_hg38.txt\"  # Motif annotations based on the 2017 cisTarget motif collection. Use these files if you are using the mc9nr databases. curl \"https://resources.aertslab.org/cistarget/motif2tf/motifs-v9-nr.hgnc-m0.001-o0.0.tbl\" \\   -o \"${SCENIC_DIR}/motifs-v9-nr.hgnc-m0.001-o0.0.tbl\""},{"path":"/articles/domino2.html","id":"downloads-for-cellphonedb","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Installation > Additional Downloads","what":"Downloads for CellPhoneDB:","title":"Get Started","text":"Database files CellPhoneDB v4.0.0 human scRNA-seq data can installed public github repository Tiechmann Group developed CellPhoneDB.","code":"CELLPHONE_DIR=\"../cellphonedb\" mkdir ${CELLPHONE_DIR}  # Annotation of protein complexes curl \"https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/complex_input.csv\" \\   -o \"${CELLPHONE_DIR}/complex_input.csv\" # Annotation of genes encoding database proteins curl \"https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/gene_input.csv\" \\   -o \"${CELLPHONE_DIR}/gene_input.csv\" # Annotated protein interactions curl \"https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/interaction_input.csv\" \\   -o \"${CELLPHONE_DIR}/interaction_input.csv\" # Annotated protein features curl \"https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/protein_input.csv\" \\   -o \"${CELLPHONE_DIR}/protein_input.csv\""},{"path":"/articles/domino2.html","id":"scenic-analysis","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference","what":"SCENIC Analysis","title":"Get Started","text":"SCENIC lab’s preferred software transcription factor activity scoring. recommend using Python implementation (pySCENIC) faster original R implementation. aware, use SCENIC often slowest memory intensive step analysis pipeline. SCENIC run computing resources access multi-core processing large amounts memory. described section saving preprocessed data, SCENIC requires RNA counts provided cell gene matrix format, using pbmc3k_counts.loom file stage analysis. pySCENIC initiated using bash scripting terminal. analysis consists 3 steps score genes transcription factor motif enrichment, construct transcription factor regulons consisting genes targeted transcription factors, arrive AUC scores enrichment regulon gene transcription within cell.","code":""},{"path":"/articles/domino2.html","id":"grn-construct-tf-modules","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > SCENIC Analysis","what":"grn: construct TF-modules","title":"Get Started","text":"Co-expression modules used quantify gene-transciption factor adjacencies.","code":"singularity exec \"${SCENIC_DIR}/aertslab-pyscenic-0.12.1.sif\" pyscenic grn \\     \"../data/pbmc3k_counts.loom\" \\     \"${SCENIC_DIR}/allTFs_hg38.txt\" \\     -o \"${SCENIC_DIR}/pbmc_adj.tsv\" \\     --num_workers 6 \\     --seed 123  # Arguments:     # path to the loom file     # list of transcription factors     # output directory for the adjacency matrix     # number of CPUs to use if multi-core processing is available     # specify a random seed for reproducibility"},{"path":"/articles/domino2.html","id":"ctx-construct-tf-regulons-with-pruning-based-on-tf-motiff-enrichment","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > SCENIC Analysis","what":"ctx: construct TF regulons with pruning based on TF motiff enrichment","title":"Get Started","text":"rankings genes based enrichment transcription factor motiffs transcription start site (TSS) considered construction regulons, target genes TF-modules removed lack motifs proximal TSS transcription factor may bind.","code":"singularity exec \"${SCENIC_DIR}/aertslab-pyscenic-0.12.1.sif\" pyscenic ctx \\     \"${SCENIC_DIR}/pbmc_adj.tsv\" \\     \"${SCENIC_DIR}/hg38_10kbp_up_10kbp_down_full_tx_v10_clust.genes_vs_motifs.rankings.feather\" \\     \"${SCENIC_DIR}/hg38_500bp_up_100bp_down_full_tx_v10_clust.genes_vs_motifs.rankings.feather\" \\     --annotations_fname \"${SCENIC_DIR}/motifs-v9-nr.hgnc-m0.001-o0.0.tbl\" \\     --expression_mtx_fname \"data/pbmc3k_counts.loom\" \\     --mode \"dask_multiprocessing\" \\     --output \"${SCENIC_DIR}/pbmc_regulons.csv\" \\     --num_workers 1                                                            # Arguments:     # adjacency matrix output from grn     # target rankings of motif enrichment within 10 kb of TSS     # target rankings of motif enrichment within 500 bp upstream and 100 bp downstream of TSS     # TF motif features     # counts matrix loom file     # enable multi-core processing     # output file of learned TF regulons     # number of CPU cores"},{"path":"/articles/domino2.html","id":"aucell-calculate-tf-activity-scores","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > SCENIC Analysis","what":"aucell: calculate TF activity scores","title":"Get Started","text":"Enrichment regulon measured Area recovery Curve (AUC) genes define regulon.","code":"singularity exec \"${SCENIC_DIR}/aertslab-pyscenic-0.12.1.sif\" pyscenic aucell \\     \"../data/pbmc3k_counts.loom\" \\     \"${SCENIC_DIR}/pbmc_regulons.csv\" \\     -o \"${SCENIC_DIR}/pbmc_auc.csv\"      # Arguments:     # counts matrix loom file     # regulon table output from ctx     # cell x TF matrix of TF enrichment AUC values"},{"path":[]},{"path":"/articles/domino2.html","id":"loading-scenic-results","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Building a Signaling Network with Domino2","what":"Loading SCENIC Results","title":"Get Started","text":"transcription factor activities required input Domino2, regulons learned SCENIC important optional input needed annotate transcription factor-target interactions prune transcription factor-receptor linkages receptor target transcription factor. prevents distinction receptor expression driving transcription factor activity transcription factor inducing receptor’s expression. initial regulons data frame read R ctx function 2 rows column names need replaced one succinct description. Domino2 changed input format transcription factor regulons list storing vectors target genes regulon, names list transcription factor genes. facilitates use alternative methods transcription factor activity quantification methods. provide helper function easy retreival transcription factor regulons output pySCENIC ctx function. Users aware AUC matrix SCENIC loaded cell x transcription factor orientation transposed transcription factor x cell orientation. pySCENIC also appends “(+)” transcription factor names converted “…” upon loading R. characters can included without affecting results Domino2 analysis, can confusing querying transcription factor features data. recommend comprehensive removal “…” characters using gsub() function.","code":"scenic_dir = \"../scenic/\" regulons <- read.csv(paste0(scenic_dir, \"/pbmc_regulons.csv\")) auc <- read.table(paste0(scenic_dir, \"/pbmc_auc.csv\"),                   header = TRUE, row.names = 1,                   stringsAsFactors = FALSE, sep = \",\") regulons <- regulons[-1:-2,] colnames(regulons) <- c(\"TF\", \"MotifID\", \"AUC\", \"NES\", \"MotifSimilarityQvalue\", \"OrthologousIdentity\", \"Annotation\", \"Context\", \"TargetGenes\", \"RankAtMax\") regulon_list <- create_regulon_list_scenic(regulons = regulons) auc_in <- as.data.frame(t(auc)) # Remove pattern \"...\" from the end of all rownames: rownames(auc_in) <- gsub(\"\\\\.\\\\.\\\\.$\", \"\", rownames(auc_in))"},{"path":"/articles/domino2.html","id":"load-cellphonedb-database","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Building a Signaling Network with Domino2","what":"Load CellPhoneDB Database","title":"Get Started","text":"Domino2 updated read ligand-receptor data bases uniform data.frame format referred receptor-ligand map (rl_map) enable use alternative updated reference databases oppossed particular version CellPhoneDB’s database older versions Domino. row corresponds ligand-receptor interaction. Genes participating interaction referred “partner ” “partner B” without requirement fixed ordering whether B ligand vice versa. minimum required columns data frame : int_pair: names interacting ligand receptor seperated \" & \" gene_A: gene genes encoding partner gene_B: gene genes encoding partner B type_A: (“L”, “R”) whether partner ligand (“L”) receptor (“R”) type_B: (“L”, “R”) whether partner B ligand (“L”) receptor (“R”) Additional annotation columns can provided name_A name_B ligands receptors whose name interaction database match names encoding genes. formatting also allows consideration ligand receptor complexes comprised heteromeric combination multiple proteins must coexpressed function. cases, “name_*” column shows name protein complex, “gene_*” column shows names genes encoding components complex separated commas “,”. plotting results build domino object, names interacting ligands receptors used based combinatorial expression complex components. facilitate use formatting CellPhoneDB database, include helper function, create_rl_map_cellphonedb(), automatically parses files cellPhoneDB database arrive rl_map format.","code":"cellphonedb_2_path <- \"../cellphonedb\" complexes <- read.csv(paste0(cellphonedb_2_path, \"/complex_input.csv\"), stringsAsFactors = FALSE) genes <- read.csv(paste0(cellphonedb_2_path, \"/gene_input.csv\"), stringsAsFactors = FALSE) interactions <- read.csv(paste0(cellphonedb_2_path, \"/interaction_input.csv\"), stringsAsFactors = FALSE) proteins <- read.csv(paste0(cellphonedb_2_path, \"/protein_input.csv\"), stringsAsFactors = FALSE)  rl_map <- create_rl_map_cellphonedb(   genes = genes,    proteins = proteins,    interactions = interactions,   complexes = complexes,   database_name = \"CellPhoneDB_v4.0\" # database version used )  knitr::kable(head(rl_map))"},{"path":"/articles/domino2.html","id":"optional-adding-interactions-manually","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Building a Signaling Network with Domino2 > Load CellPhoneDB Database","what":"Optional: Adding interactions manually","title":"Get Started","text":"change use rl_map formatting also enables users manually append interactions interest included interaction database need . can attained formatting desired interactions data.frame column headers rl_map using rbind() function.","code":"# Integrin complexes are not annotated as receptors in CellPhoneDB_v4.0 # collagen-integrin interactions between cells may be missed unless tables from the CellPhoneDB reference are edited or the interactions are manually added  col_int_df <- data.frame(   \"int_pair\" = \"a11b1 complex & COLA1_HUMAN\",   \"name_A\" = \"a11b1 complex\", \"uniprot_A\" = \"P05556,Q9UKX5\", \"gene_A\" = \"ITB1,ITA11\", \"type_A\" = \"R\",   \"name_B\" = \"COLA1_HUMAN\", \"uniprot_B\" = \"P02452,P08123\", \"gene_B\" = \"COL1A1,COL1A2\", \"type_B\" = \"L\",   \"annotation_strategy\" = \"manual\", \"source\" = \"manual\", \"database_name\" = \"manual\" ) rl_map_append <- rbind(col_int_df, rl_map) knitr::kable(head(rl_map_append))"},{"path":"/articles/domino2.html","id":"creating-the-domino-object","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference","what":"Creating the Domino Object","title":"Get Started","text":"Domino2 analysis takes place two steps. 1. create_domino() . initializes domino result object b. assesses differential transcription factor activity across cell clusters wilcoxon rank-sum test c. establishes transcription factor-receptor linkages based Spearman correlation transcription factor activities receptor expression across queried data set. 2. build_domino() . sets parameters transcription factors receptors called active within cell cluster b. aggregates scaled expression ligands capable interacting active receptors assessment ligand type cellular source triggering activation receptor.","code":""},{"path":"/articles/domino2.html","id":"required-inputs-from-data-set","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Creating the Domino Object","what":"Required inputs from data set","title":"Get Started","text":"Domino2 infers active receipt signals via receptors based correlation receptor’s expression transcription factor activity across data set differential activity transcription factor within cell cluster. Correlations conducted using scaled expression values rather raw counts normalized counts. assessment receptor activity per cell type basis, named vector cell cluster assignments, names cell barcodes matching expression matrix, provided. Assessing signaling based categorical groupings cells can acheived passing groupings “clusters” build_domino() place cell types. Domino2 accepts either Seurat object counts, scaled counts, clusters included, requires matrix counts, matrix scaled counts, named vector cell cluster labels factors. Shown extract elements Seurat object. Note: Ligand receptor expression can assessed genes included z_scores matrix. Many scRNA-seq analysis pipelines recommend storing genes high variance scaled expression slots data objects, thereby missing many genes encoding ligands receptors. Ensure genes interest included rows z_scores matrix. Scaled expression calculated genes PBMC data set removal genes expressed less 3 cells.","code":"counts <- pbmc@assays$RNA@counts z_scores <- as.matrix(pbmc@assays$RNA@scale.data) clusters <- as.factor(pbmc$cell_type)"},{"path":"/articles/domino2.html","id":"create-domino-object","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Creating the Domino Object","what":"Create Domino object","title":"Get Started","text":"point, create_domino() function can used make object. Parameters note include “use_clusters” required assess signaling cell types rather linkage transcription factors receptors broadly across data set. “use_complexes” decides receptors function heteromeric complexes considered testing linkages transcription factors receptors. TRUE, receptor complex linked transcription factor majority component genes meet Spearman correlation threshold. “remove_rec_dropout” decides whether receptor values 0 considered correlation calculations; measure intended reduce effect dropout receptors wiht low expression. run create_domino() matrix vector inputs: results equivalent using Seurat object directly. Note inclusion matrix inputs Seurat object prioritize Seurat object. information stored domino object access , please see vignette structure domino objects.","code":"pbmc_dom <- create_domino(   rl_map = rl_map,             # receptor-ligand map data frame   features = auc_in,           # Transcription factor scores (AUC matrix)   counts = counts,             # counts matrix   z_scores = z_scores,         # scaled expression data   clusters = clusters,         # vector of cell cluster assignments   tf_targets = regulon_list,   # list of TFs and their reglons   use_clusters = TRUE,         # assess receptor activation and ligand expression on a per-cluster basis   use_complexes = TRUE,        # include receptors and genes that function as a complex in results   remove_rec_dropout = FALSE   # whether to remove zeroes from correlation calculations ) pbmc_dom <- create_domino(   rl_map = rl_map,             # receptor-ligand map data frame   features = auc_in,           # Transcription factor scores (AUC matrix)   ser = pbmc,                  # Seurat object containing counts, scaled counts, and cell cluster assignments   tf_targets = regulon_list,   # list of TFs and their reglons   use_clusters = TRUE,         # assess receptor activation and ligand expression on a per-cluster basis   use_complexes = TRUE,        # include receptors and genes that function as a complex in results   remove_rec_dropout = FALSE   # whether to remove zeroes from correlation calculations )"},{"path":"/articles/domino2.html","id":"build-domino","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Creating the Domino Object","what":"Build Domino","title":"Get Started","text":"build_domino() finalizes construction domino object setting parameters identifying transcription factors differential activation clusters, receptor linkage transcription factors based magnitude positive correlation, minimum percentage cells within cluster expression receptor receptor called active. also options thresholds number transcription factors may called active cluster number receptors may linked one transcription factor. thresholds n transcription factors m receptors, bottom n transcription factors lowest p-values wilcoxon rank sum test top m receptors Spearman correlation coefficient chosen. thresholds number receptors transcription factors can sent infinity (Inf) collect receptors transcription factors meet statistical significance thresholds.","code":"pbmc_dom <- build_domino(   dom = pbmc_dom,   min_tf_pval = .001, # Threshold for p-value of DE for TFs   max_tf_per_clust = 5,   max_rec_per_tf = 5,   rec_tf_cor_threshold = .25, # Minimum correlation between receptor and TF   min_rec_percentage = 0.1 # Minimum percent of cells that must express receptor ) dom_b <- build_domino(   dom = dom,   min_tf_pval = .001,   max_tf_per_clust = Inf,   max_rec_per_tf = Inf,   rec_tf_cor_threshold = .25,   min_rec_percentage = 0.1 )"},{"path":"/articles/domino2.html","id":"visualization-of-domino-results","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference","what":"Visualization of Domino Results","title":"Get Started","text":"Multiple functions available visualize intracellular networks receptors transcription factors ligand-receptor mediated intercellular networks cell types.","code":""},{"path":"/articles/domino2.html","id":"summarize-transcription-factor-activity-and-linkage","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Visualization of Domino Results","what":"Summarize Transcription Factor Activity and Linkage","title":"Get Started","text":"Enrichment transcription factor activities cell types can visualized feat_heatmap() plots data set-wide transcription factor activity scores pheatmap. mark_connections argument determines whether X used mark linked transcription factors receptors.","code":"feat_heatmap(pbmc_dom, norm = TRUE, bool = FALSE, mark_connections = TRUE)"},{"path":"/articles/domino2.html","id":"cumulative-signaling-between-cell-types","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Visualization of Domino Results","what":"Cumulative signaling between cell types","title":"Get Started","text":"cummulative degree signaling clusters assessed sum scaled expressin ligands targeting active receptors another cluster. can visualized graph format using signaling_network() function. Nodes represent cell cluster edges scale magnitude signaling clusters. color edge corresponds sender cluster signal. Signaling networks can also drawn edges rendering signals directed towards given cell type signals one cell type directed others. see options use, well plotting options, please see plotting vignette.","code":"signaling_network(pbmc_dom, edge_weight = .5, max_thresh = 2.5)"},{"path":"/articles/domino2.html","id":"specific-signaling-interactions-between-clusters","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference > Visualization of Domino Results","what":"Specific Signaling Interactions between Clusters","title":"Get Started","text":"Beyond aggregated degree signaling cell types, degrees signaling specific ligand-receptor interactions can assessed. gene_network() provides graph linkages active transcription factors cluster, linked receptors cluster, possible ligands active recptors New Domino2, gene_network() can used two clusters determine possible ligands given receptor expressed putative outgoing signaling cluster. comprehensive assessment ligand expression targeting active receptors given cluster can assessed incoming_signaling_heatmap(). Another form comprehensive ligand expression assessment available individual active receptors form circos plots new Domino2. outer arcs correspond clusters domino object inner arcs representing possible ligand plotted receptor. Arcs drawn ligands cell type receptor ligand expressed specified threshold. Arc widths correspond mean express ligand cluster widest arc width scaling maximum expression ligand within data.","code":"gene_network(pbmc_dom, clust = 'dendritic_cell', layout = 'grid') gene_network(pbmc_dom, clust = 'dendritic_cell', OutgoingSignalingClust = \"CD14_monocyte\",               layout = 'grid') incoming_signaling_heatmap(pbmc_dom, rec_clust = 'dendritic_cell', max_thresh = 2.5) circos_ligand_receptor(pbmc_dom, receptor = \"CD74\")"},{"path":"/articles/domino2.html","id":"continued-development","dir":"Articles","previous_headings":"Using Domino2 v0.2.1 for cell-cell communication inference","what":"Continued Development","title":"Get Started","text":"Since Domino2 package still developed, new functions features implemented future versions. meantime, put together information plotting domino object structure like explore package’s functionality. Additionally, find bugs, questions, want share idea, please let us know .","code":""},{"path":"/articles/domino_object_vignette.html","id":"accessing-information-in-the-new-domino-object-structure","dir":"Articles","previous_headings":"","what":"Accessing information in the new domino object structure","title":"Interacting with Domino2 Objects","text":"order better implement changes made Domino2, structure domino object modified. , describe data stored domino object, well best access use may mind.","code":""},{"path":"/articles/plotting_vignette.html","id":"visualizing-domino2-data","dir":"Articles","previous_headings":"","what":"Visualizing Domino2 data","title":"Plotting Functions and Options","text":"addition numerous plotting options available original Domino, Domino2 added functionality new methods improve visualization interpretation analysis results. , go different plotting functions available, well different options can utilized, options customization. using domino object example analysis Getting Started.","code":""},{"path":"/articles/plotting_vignette.html","id":"updates-to-original-plotting-functions","dir":"Articles","previous_headings":"Visualizing Domino2 data","what":"Updates to Original Plotting Functions:","title":"Plotting Functions and Options","text":"Functions: * circos_ligand_receptor() * cor_heatmap() * cor_scatter() * feat_heatmap() * gene_network() * incoming_signaling_heatmap() * signaling_heatmap() * signaling_network() circos plot also includes functionality change colors used cell type correspond figures primary analysis scRNA-seq data set.","code":"# bug in plotting parameters  ## Error in plot.window(...) : need finite 'xlim' values # signaling_network(pbmc_dom, edge_weight = .5, max_thresh = 2.5, #                   showIncomingSignalingClusts = \"dendritic_cell\") signaling_network(pbmc_dom, edge_weight = .5, max_thresh = 2.5,                   showOutgoingSignalingClusts = \"CD14_monocyte\") cell_types <- unique(pbmc_dom@clusters) cell_palette <- dittoSeq::dittoColors()[1:length(cell_types)] names(cell_palette) <- cell_types  circos_ligand_receptor(pbmc_dom, receptor = \"CD74\", cell_colors = cell_palette) -->"},{"path":[]},{"path":"/articles/vignette.html","id":"preprocessing-scrnaseq-data","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference","what":"Preprocessing scRNAseq data","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Domino2 tool analysis intra- intercellular signaling single cell RNA sequencing data based transcription factor activation. vignette intended demonstrate basic pipeline generating communication networks domino object using single cell RNA sequencing(scRNAseq) data. Analysis cell-cell communication (CCC) Domino2 often follows initial pre-processing annotation scRNAseq data. vignette demonstrate use Domino2 10X Genomics Peripheral Blood Mononuclear Cells (PBMC) data set 2,700 cells processed following Satija Lab’s Seurat tutorial. data can downloaded .","code":"# Preprocessing of PBMC 3K tutorial data set pbmc.data <- Read10X(data.dir = \"../data/pbmc3k_filtered_gene_bc_matrices\") pbmc <- CreateSeuratObject(counts = pbmc.data, project = \"pbmc3k\", min.cells = 3, min.features = 200) pbmc[[\"percent.mt\"]] <- PercentageFeatureSet(pbmc, pattern = \"^MT-\") pbmc <- NormalizeData(pbmc, normalization.method = \"LogNormalize\", scale.factor = 10000) pbmc <- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000) pbmc <- ScaleData(pbmc, features = rownames(pbmc)) pbmc <- RunPCA(pbmc, features = VariableFeatures(object = pbmc)) pbmc <- FindNeighbors(pbmc, dims = 1:10) pbmc <- FindClusters(pbmc, resolution = 0.5) pbmc <- RunUMAP(pbmc, dims = 1:10) # Annotate clusters with cell phenotypes cell_dict <- data.frame(   cluster = c(0:8),   cell_type = c(\"naive_CD4_T_cell\", \"CD14_monocyte\", \"memory_CD4_T_cell\", \"B_cell\", \"CD8_T_cell\", \"CD16_monocyte\", \"NK_cell\", \"dendritic_cell\", \"platelet\") ) pbmc$cell_type <-    plyr::mapvalues(     pbmc$seurat_clusters,     from = cell_dict$cluster,     to = cell_dict$cell_type   )"},{"path":"/articles/vignette.html","id":"saving-preprocessed-data","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Preprocessing scRNAseq data","what":"Saving Preprocessed Data:","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Domino2 designed compatible Seurat objects addition accepting matrices vectors data set function inputs. Therefore, ’s good idea save processed Seurat object analysis. However, pySCENIC used transcription factor activation inference, requires input cell gene matrix. opposite orientation Seurat objects default Python based tools scanpy. Saving data loom file using loomR helpful step therefore recommended well. cell x gene counts matrix may also saved tab-separated value (.tsv) file loomR used computing resource, aware dense formatting .tsv can lead large file sizes slow processing large data sets. provided necessary code , due large file size, .tsv file provided data directory. like skip ahead rest analysis, processed objects steps available data directory package.","code":"# save Seurat object as RDS saveRDS(pbmc, file = \"../data/pbmc3k_seurat.rds\")  # save loom counts matrix pbmc_counts <- pbmc@assays$RNA@counts pbmc_loom <- loomR::create(filename = \"../data/pbmc3k_counts.loom\", data = pbmc_counts) pbmc_loom$close_all() # Remember to manually close connection to loom files! pbmc_counts <- pbmc@assays$RNA@counts write.table(t(as.matrix(pbmc_counts)), \"../data/pbmc3k_counts.tsv\",      sep = \"\\t\", col.names = NA)"},{"path":"/articles/vignette.html","id":"installation","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference","what":"Installation","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Domino2 undergoing active development aspects data used, analyzed, interpreted subject change new features fixes implemented. v0.2.1 Domino2 serves first stable development version active updates reproducible usage implemented fixes handling receptors ligands function heteromeric complexes, consideration receptor expression per-cluster basis linkage transcription factors, reformatting receptor-ligand database transcription factor regulon inputs enabling Domino2 use alternative data bases transcription factor activity inference methods. version currently hosted FertigLab GitHub branch v0.2.1 domino_development repository forked primary repository hosted Elisseeff-Lab GitHub, can installed using remotes package.","code":"if(!require(remotes)){     install.packages('remotes') } remotes::install_github('FertigLab/domino_development@v0.2.1')"},{"path":"/articles/vignette.html","id":"additional-downloads","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Installation","what":"Additional Downloads","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"tutorial, pySCENIC used method transcription factor activity inference assessment ligand-receptor interactions based curated interactions CellPhoneDB v4.0.0. requires downloading files prior use analysis pipeline.","code":""},{"path":"/articles/vignette.html","id":"downloads-for-scenic","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Installation > Additional Downloads","what":"Downloads for SCENIC:","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"singularity image SCENIC v0.12.1 can installed DockerHub image source (example scripts use Docker provided scenic_bash directory well). SCENIC requires list transcription factors, motif annotations, cisTarget motifs available authors SCENIC human (HGNC), mouse (MGI), fly. following download everything necessary analysis data set HGNC gene labels hg38 genome.","code":"SCENIC_DIR=\"scenic\" mkdir ${SCENIC_DIR}  # Build singularity image singularity build \"${SCENIC_DIR}/aertslab-pyscenic-0.12.1.sif\" docker://aertslab/pyscenic:0.12.1  # Matrix containing motifs as rows and genes as columns and ranking position for each gene and motif (based on CRM scores) as values curl \"https://resources.aertslab.org/cistarget/databases/old/homo_sapiens/hg38/refseq_r80/mc9nr/gene_based/hg38__refseq-r80__10kb_up_and_down_tss.mc9nr.feather\" \\   -o \"${SCENIC_DIR}/hg38__refseq-r80__10kb_up_and_down_tss.mc9nr.feather\" curl \"https://resources.aertslab.org/cistarget/databases/old/homo_sapiens/hg38/refseq_r80/mc9nr/gene_based/hg38__refseq-r80__500bp_up_and_100bp_down_tss.mc9nr.feather\" \\   -o \"${SCENIC_DIR}/hg38__refseq-r80__500bp_up_and_100bp_down_tss.mc9nr.feather\" # List of genes encoding transcription factors in the HG38 reference genome curl \"https://resources.aertslab.org/cistarget/tf_lists/allTFs_hg38.txt\" \\   -o \"${SCENIC_DIR}/allTFs_hg38.txt\" # Motif annotations based on the 2017 cisTarget motif collection. Use these files if you are using the mc9nr databases. curl \"https://resources.aertslab.org/cistarget/motif2tf/motifs-v9-nr.hgnc-m0.001-o0.0.tbl\" \\   -o \"${SCENIC_DIR}/motifs-v9-nr.hgnc-m0.001-o0.0.tbl\""},{"path":"/articles/vignette.html","id":"downloads-for-cellphonedb","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Installation > Additional Downloads","what":"Downloads for CellPhoneDB:","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Database files CellPhoneDB v4.0.0 human scRNA-seq data can installed public github repository Tiechmann Group developed CellPhoneDB.","code":"CELLPHONE_DIR=\"cellphonedb\" mkdir ${CELLPHONE_DIR}  # Annotation of protein complexes curl \"https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/complex_input.csv\" \\   -o \"${CELLPHONE_DIR}/complex_input.csv\" # Annotation of genes encoding database proteins curl \"https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/gene_input.csv\" \\   -o \"${CELLPHONE_DIR}/gene_input.csv\" # Annotated protein interactions curl \"https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/interaction_input.csv\" \\   -o \"${CELLPHONE_DIR}/interaction_input.csv\" # Annotated protein features curl \"https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/protein_input.csv\" \\   -o \"${CELLPHONE_DIR}/protein_input.csv\""},{"path":"/articles/vignette.html","id":"scenic-analysis","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference","what":"SCENIC Analysis","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"SCENIC lab’s preferred software transcription factor activity scoring. recommend using Python implementation (pySCENIC) faster original R implementation. aware, use SCENIC often slowest memory intensive step analysis pipeline. SCENIC run computing resources access multi-core processing large amounts memory. described section saving preprocessed data, SCENIC requires RNA counts provided cell gene matrix format, using pbmc3k_counts.loom file stage analysis. pySCENIC initiated using bash scripting terminal. analysis consists 3 steps score genes transcription factor motif enrichment, construct transcription factor regulons consisting genes targeted transcription factors, arrive AUC scores enrichment regulon gene transcription within cell.","code":""},{"path":"/articles/vignette.html","id":"grn-construct-tf-modules","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > SCENIC Analysis","what":"grn: construct TF-modules","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Co-expression modules used quantify gene-transciption factor adjacencies.","code":"singularity exec \"${SCENIC_DIR}/aertslab-pyscenic-0.12.1.sif\" pyscenic grn \\     \"../data/pbmc3k_counts.loom\" \\         # path to the loom file     \"${SCENIC_DIR}/allTFs_hg38.txt\" \\                        # list of transcription factors      -o \"${SCENIC_DIR}/pbmc_adj.tsv\" \\                        # output directory for the adjacency matrix     --num_workers 6 \\                                 # number of CPUs to use if multi-core processing is available     --set_seed 123                                    # specify a random seed for reproducibility"},{"path":"/articles/vignette.html","id":"ctx-construct-tf-regulons-with-pruning-based-on-tf-motiff-enrichment","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > SCENIC Analysis","what":"ctx: construct TF regulons with pruning based on TF motiff enrichment","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"rankings genes based enrichment transcription factor motiffs transcription start site (TSS) considered construction regulons, target genes TF-modules removed lack motifs proximal TSS transcription factor may bind.","code":"singularity exec \"${SCENIC_DIR}/aertslab-pyscenic-0.12.1.sif\" pyscenic ctx \\     \"${SCENIC_DIR}/pbmc_adj.tsv\" \\                                                   # adjacency matrix output from grn     \"${SCENIC_DIR}/hg38__refseq-r80__10kb_up_and_down_tss.mc9nr.feather\" \\           # target rankings of motif enrichment within 10 kb of TSS     \"${SCENIC_DIR}/hg38__refseq-r80__500bp_up_and_100bp_down_tss.mc9nr.feather\" \\    # target rankings of motif enrichment within 500 bp upstream and 100 bp downstream of TSS     --annotations_fname \"${SCENIC_DIR}/motifs-v9-nr.hgnc-m0.001-o0.0.tbl\" \\          # TF motif features     --expression_mtx_fname \"../data/pbmc3k_counts.loom\" \\          # counts matrix loom file     --mode \"dask_multiprocessing\" \\                                           # enable multi-core processing     --output \"${SCENIC_DIR}/pbmc_regulons.csv\" \\                                     # output file of learned TF regulons     --num_workers 6                                                           # number of CPU cores"},{"path":"/articles/vignette.html","id":"aucell-calculate-tf-activity-scores","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > SCENIC Analysis","what":"aucell: calculate TF activity scores","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Enrichment regulon measured Area recovery Curve (AUC) genes define regulon.","code":"singularity exec \"${SCENIC_DIR}/aertslab-pyscenic-0.12.1.sif\" pyscenic aucell \\     \"../data/pbmc3k_counts.loom\" \\   # counts matrix loom file     \"${SCENIC_DIR}/pbmc_regulons.csv\" \\                # regulon table output from ctx     -o \"${SCENIC_DIR}/pbmc_auc.csv\"                    # cell x TF matrix of TF enrichment AUC values"},{"path":[]},{"path":"/articles/vignette.html","id":"loading-scenic-results","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Building a Signaling Network with Domino2","what":"Loading SCENIC Results","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"transcription factor activities required input Domino2, regulons learned SCENIC important optional input needed annotate transcription factor-target interactions prune transcription factor-receptor linkages receptor target transcription factor. prevents distinction receptor expression driving transcription factor activity transcription factor inducing receptor’s expression. initial regulons data frame read R ctx function 2 rows column names need replaced one succinct description. Domino2 changed input format transcription factor regulons list storing vectors target genes regulon, names list transcription factor genes. facilitates use alternative methods transcription factor activity quantification methods. provide helper function easy retreival transcription factor regulons output pySCENIC ctx function. Users aware AUC matrix SCENIC loaded cell x transcription factor orientation transposed transcription factor x cell orientation. pySCENIC also appends “(+)” transcription factor names converted “…” upon loading R. characters can included without affecting results Domino2 analysis, can confusing querying transcription factor features data. recommend comprehensive removal “…” characters using gsub() function.","code":"scenic_dir = \"scenic/\" regulons <- read.csv(paste0(scenic_dir, \"/pbmc_regulons.csv\")) auc <- read.table(paste0(scenic_dir, \"scenic/pbmc_auc.csv\"),                   header = TRUE, row.names = 1,                   stringsAsFactors = FALSE, sep = \",\") regulons <- regulons[-1:-2,] colnames(regulons) <- c(\"TF\", \"MotifID\", \"AUC\", \"NES\", \"MotifSimilarityQvalue\", \"OrthologousIdentity\", \"Annotation\", \"Context\", \"TargetGenes\", \"RankAtMax\") regulon_list <- create_regulon_list_scenic(regulons = regulons) auc_in <- as.data.frame(t(auc)) rownames(auc_in) <- gsub(\"\\\\.\\\\.\\\\.$\", \"\", rownames(auc_in)) # remove pattern \"...\" from the end of all rownames"},{"path":"/articles/vignette.html","id":"load-cellphonedb-database","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Building a Signaling Network with Domino2","what":"Load CellPhoneDB Database","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Domino2 updated read ligand-receptor data bases uniform data.frame format referred receptor-ligand map (rl_map) enable use alternative updated reference databases oppossed particular version CellPhoneDB’s database older versions Domino. row corresponds ligand-receptor interaction. Genes participating interaction referred “partner ” “partner B” without requirement fixed ordering whether B ligand vice versa. minimum required columns data frame : int_pair: names interacting ligand receptor seperated \" & \" gene_A: gene genes encoding partner gene_B: gene genes encoding partner B type_A: (“L”, “R”) whether partner ligand (“L”) receptor (“R”) type_B: (“L”, “R”) whether partner B ligand (“L”) receptor (“R”) Additional annotation columns can provided name_A name_B ligands receptors whose name interaction database match names encoding genes. formatting also allows consideration ligand receptor complexes comprised heteromeric combination multiple proteins must coexpressed function. cases, “name_*” column shows name protein complex, “gene_*” column shows names genes encoding components complex separated commas “,”. plotting results build domino object, names interacting ligands receptors used based combinatorial expression complex components. facilitate use formatting CellPhoneDB database, include helper function automatically parses files cellPhoneDB database arrive rl_map format.","code":"cellphonedb_2_path <- \"cellphonedb\" complexes <- read.csv(paste0(cellphonedb_2_path, \"/complex_input.csv\"), stringsAsFactors = FALSE) genes <- read.csv(paste0(cellphonedb_2_path, \"/gene_input.csv\"), stringsAsFactors = FALSE) interactions <- read.csv(paste0(cellphonedb_2_path, \"/interaction_input.csv\"), stringsAsFactors = FALSE) proteins <- read.csv(paste0(cellphonedb_2_path, \"/protein_input.csv\"), stringsAsFactors = FALSE)  rl_map <- create_rl_map_cellphonedb(   genes = genes,    proteins = proteins,    interactions = interactions,   complexes = complexes,   database_name = \"CellPhoneDB_v4.0\" # includes database version used )  knitr::kable(head(rl_map))"},{"path":"/articles/vignette.html","id":"optional-adding-interactions-manually","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Building a Signaling Network with Domino2 > Load CellPhoneDB Database","what":"Optional: Adding interactions manually","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"change use rl_map formatting also enables users manually append interactions interest included interaction database need . can attained formatting desired interactions data.frame column headers rl_map using rbind() function.","code":"# Integrin complexes are not annotated as receptors in CellPhoneDB_v4.0 # collagen-integrin interactions between cells may be missed unless tables from the CellPhoneDB reference are edited or the interactions are manually added  col_int_df <- data.frame(   \"int_pair\" = \"a11b1 complex & COLA1_HUMAN\",   \"name_A\" = \"a11b1 complex\", \"uniprot_A\" = \"P05556,Q9UKX5\", \"gene_A\" = \"ITB1,ITA11\", \"type_A\" = \"R\",   \"name_B\" = \"COLA1_HUMAN\", \"uniprot_B\" = \"P02452,P08123\", \"gene_B\" = \"COL1A1,COL1A2\", \"type_B\" = \"L\",   \"annotation_strategy\" = \"manual\", \"source\" = \"manual\", \"database_name\" = \"manual\" ) rl_map_append <- rbind(col_int_df, rl_map) knitr::kable(head(rl_map_append))"},{"path":"/articles/vignette.html","id":"creating-the-domino-object","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference","what":"Creating the Domino Object","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Domino2 analysis takes place two steps. 1. create_domino() . initializes domino result object b. assesses differential transcription factor activity across cell clusters wilcoxon rank-sum test c. establishes transcription factor-receptor linkages based Spearman correlation transcription factor activities receptor expression across queried data set. 2. build_domino() . sets parameters transcription factors receptors called active within cell cluster b. aggregates scaled expression ligands capable interacting active receptors assessment ligand type cellular source triggering activation receptor.","code":""},{"path":"/articles/vignette.html","id":"required-inputs-from-data-set","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Creating the Domino Object","what":"Required inputs from data set","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Domino2 infers active receipt signals via receptors based correlation receptor’s expression transcription factor activity across data set differential activity transcription factor within cell cluster. Correlations conducted using scaled expression values rather raw counts normalized counts. assessment receptor activity per cell type basis, named vector cell cluster assignments, names cell barcodes matching expression matrix, provided. Assessing signaling based categorical groupings cells can acheived passing groupings “clusters” build_domino() place cell types. Domino2 accepts either Seurat object counts, scaled counts, clusters included, requires matrix counts, matrix scaled counts, named vector cell cluster labels factors. Shown extract elements Seurat object. Note: Ligand receptor expression can assessed genes included z_scores matrix. Many scRNA-seq analysis pipelines recommend storing genes high variance scaled expression slots data objects, thereby missing many genes encoding ligands receptors. Ensure genes interest included rows z_scores matrix. Scaled expression calculated genes PBMC data set removal genes expressed less 3 cells.","code":"counts <- pbmc@assays$RNA@counts z_scores <- as.matrix(pbmc@assays$RNA@scale.data) clusters <- as.factor(pbmc$cell_type)"},{"path":"/articles/vignette.html","id":"create-domino-object","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Creating the Domino Object","what":"Create Domino object","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"point, create_domino() function can used make object. Parameters note include “use_clusters” required assess signaling cell types rather linkage transcription factors receptors broadly across data set. “use_complexes” decides receptors function heteromeric complexes considered testing linkages transcription factors receptors. TRUE, receptor complex linked transcription factor majority component genes meet Spearman correlation threshold. “remove_rec_dropout” decides whether receptor values 0 considered correlation calculations; measure intended reduce effect dropout receptors wiht low expression. run create_domino() matrix vector inputs: results equivalent using Seurat object directly. Note inclusion matrix inputs Seurat object prioritize Seurat objects. information stored domino object access , please see vignette structure domino objects.","code":"pbmc_dom <- create_domino(   rl_map = rl_map,             # receptor-ligand map data frame   features = auc_in,           # Transcription factor scores (AUC matrix)   counts = counts,             # counts matrix   z_scores = z_scores,         # scaled expression data   clusters = clusters,         # vector of cell cluster assignments   tf_targets = regulon_list,   # list of TFs and their reglons   use_clusters = TRUE,         # assess receptor activation and ligand expression on a per-cluster basis   use_complexes = TRUE,        # include receptors and genes that function as a complex in results   remove_rec_dropout = FALSE   # whether to remove zeroes from correlation calculations ) pbmc_dom <- create_domino(   rl_map = rl_map,             # receptor-ligand map data frame   features = auc_in,           # Transcription factor scores (AUC matrix)   ser = pbmc,                  # Seurat object containing counts, scaled counts, and cell cluster assignments   tf_targets = regulon_list,   # list of TFs and their reglons   use_clusters = TRUE,         # assess receptor activation and ligand expression on a per-cluster basis   use_complexes = TRUE,        # include receptors and genes that function as a complex in results   remove_rec_dropout = FALSE   # whether to remove zeroes from correlation calculations )"},{"path":"/articles/vignette.html","id":"build-domino","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Creating the Domino Object","what":"Build Domino","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"build_domino() finalizes construction domino object setting parameters identifying transcription factors differential activation clusters, receptor linkage transcription factors based magnitude positive correlation, minimum percentage cells within cluster expression receptor receptor called active. also options thresholds number transcription factors may called active cluster number receptors may linked one transcription factor. thresholds n transcription factors m receptors, bottom n transcription factors lowest p-values wilcoxon rank sum test top m receptors Spearman correlation coefficient chosen. thresholds number receptors transcription factors can sent infinity (Inf) collect receptors transcription factors meet statistical significance thresholds.","code":"pbmc_dom <- build_domino(   dom = pbmc_dom,   min_tf_pval = .001, # Threshold for p-value of DE for TFs   max_tf_per_clust = 5,   max_rec_per_tf = 5,   rec_tf_cor_threshold = .25, # Minimum correlation between receptor and TF   min_rec_percentage = 0.1 # Minimum percent of cells that must express receptor ) dom_b <- build_domino(   dom = dom,   min_tf_pval = .001,   max_tf_per_clust = Inf,   max_rec_per_tf = Inf,   rec_tf_cor_threshold = .25,   min_rec_percentage = 0.1 )"},{"path":"/articles/vignette.html","id":"visualization-of-domino-results","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference","what":"Visualization of Domino Results","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Multiple functions available visualize intracellular networks receptors transcription factors ligand-receptor mediated intercellular networks cell types.","code":""},{"path":"/articles/vignette.html","id":"summarize-transcription-factor-activity-and-linkage","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Visualization of Domino Results","what":"Summarize Transcription Factor Activity and Linkage","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Enrichment transcription factor activities cell types can visualized feat_heatmap() plots data set-wide transcription factor activity scores pheatmap. mark_connections argument determines whether X used mark linked transcription factors receptors.","code":"feat_heatmap(pbmc_dom, norm = TRUE, bool = FALSE, mark_connections = TRUE)"},{"path":"/articles/vignette.html","id":"cumulative-signaling-between-cell-types","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Visualization of Domino Results","what":"Cumulative signaling between cell types","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"cummulative degree signaling clusters assessed sum scaled expressin ligands targeting active receptors another cluster. can visualized graph format using signaling_network() function. Nodes represent cell cluster edges scale magnitude signaling clusters. color edge corresponds sender cluster signal. Signaling networks can also drawn edges render signals directed towards given cell type signals one cell type directed others can also created. see options use, well plotting options, please see plotting vignette.","code":"signaling_network(pbmc_dom, edge_weight = .5, max_thresh = 2.5)"},{"path":"/articles/vignette.html","id":"specific-signaling-interactions-between-clusters","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference > Visualization of Domino Results","what":"Specific Signaling Interactions between Clusters","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Beyond aggregated degree signaling cell types, degrees signaling specific ligand-receptor interactions can assessed. gene_network() provides graph linkages active transcription factors cluster, linked receptors cluster, possible ligands active recptors New Domino2, gene_network() can used two clusters determine possible ligands given receptor expressed putative outgoing signaling cluster. comprehensive assessment ligand expression targeting active receptors given cluster can assessed incoming_signaling_heatmap(). Another form comprehensive ligand expression assessment available individual active receptors form circos plots new Domino2. outer arcs correspond clusters domino object inner arcs representing possible ligand plotted receptor. Arcs drawn ligands cell type receptor ligand expressed specified threshold. Arc widths correspond mean express ligand cluster widest arc width scaling maximum expression ligand within data.","code":"gene_network(pbmc_dom, clust = 'dendritic_cell', layout = 'grid') gene_network(pbmc_dom, clust = 'dendritic_cell', OutgoingSignalingClust = \"CD14_monocyte\",               layout = 'grid') incoming_signaling_heatmap(pbmc_dom, rec_clust = 'dendritic_cell', max_thresh = 2.5) circos_ligand_receptor(pbmc_dom, receptor = \"CD74\")"},{"path":"/articles/vignette.html","id":"continued-development","dir":"Articles","previous_headings":"Introduction to using Domino2 for cell-cell communication inference","what":"Continued Development","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"Since Domino2 package still development, new functions features development. github repository contains branches changes implemented. Additionally, find bugs, questions, features like request, please let us know .","code":""},{"path":[]},{"path":"/articles/vignette.html","id":"vignette-build-info","dir":"Articles","previous_headings":"","what":"Cell Cell Communication with Domino2: v0.2.1 Vignette","title":"Cell Cell Communication with Domino2: v0.2.1 Vignette","text":"","code":"sys.date() sessionInfo()"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Christopher Cherry. Author. Jacob T Mitchell. Author. Sushma Nagaraj. Author. Kavita Krishnan. Author. Elana Fertig. Contributor. Jennifer Elisseeff. Contributor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Cherry C, Mitchell JT, Nagaraj S, Krishnan K (2023). domino2: Cell Communication Analysis Single Cell RNA Sequencing. R package version 0.2.1.","code":"@Manual{,   title = {domino2: Cell Communication Analysis for Single Cell RNA Sequencing},   author = {Christopher Cherry and Jacob T Mitchell and Sushma Nagaraj and Kavita Krishnan},   year = {2023},   note = {R package version 0.2.1}, }"},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Cell Communication from Single Cell RNA Sequencing Data","text":"Domino2 undergoing active development aspects data used, analyzed, interpreted subject change new features fixes implemented. v0.2.1 Domino2 serves first stable development version active updates reproducible usage (see News page information changes). version currently hosted FertigLab GitHub branch v0.2.1 domino_development repository forked primary repository hosted Elisseeff-Lab GitHub, can installed using remotes package.","code":"if(!require(remotes)){     install.packages('remotes') } remotes::install_github('FertigLab/domino_development@v0.2.1')"},{"path":"/index.html","id":"usage-overview","dir":"","previous_headings":"","what":"Usage Overview","title":"Cell Communication from Single Cell RNA Sequencing Data","text":"overview domino2 might used analysis single cell RNA sequencing data set: Transcription factor activation scores calculated (recommend using pySCENIC, methods can used well) ligand-receptor database used map linkages ligands receptors (recommend using CellphoneDB, methods can used well). domino object created using counts, z-scored counts, clustering information, data steps 1 2. Parameters maximum number transcription factors receptors minimum correlation threshold (among others) used make cell communication network Communication networks can extracted within domino object visualized using variety plotting functions Please see Getting Started page example analysis includes steps detail, downloading running pySCENIC building visualizing domino results. articles include details plotting functions structure domino object.","code":""},{"path":[]},{"path":"/news/news-0.2.html","id":"updates-to-domino-object-construction-0-2-1","dir":"News","previous_headings":"Domino2 v0.2.1","what":"Updates to domino object construction","title":"Version 0.2","text":"Uniform formats inputs receptor-ligand interaction databases, tf activity features, regulon gene lists operability alternative databases tf activity inference methods Helper functions reformatting pySCENIC outputs CellPhoneDB database files domino-readable uniform formats Assessment transcription factor linkage receptors function heteromeric complex based correlation transcription factor activity receptor component genes Assessment complex ligand expression mean component gene expression plotting functions Minimum threshold percentage cells cluster expressing receptor gene receptor called active within cluster Additional linkage slots active receptors cluster, transcription factor-receptor linkages cluster, incoming ligands active receptors cluster","code":""},{"path":"/news/news-0.2.html","id":"plotting-functions-0-2-1","dir":"News","previous_headings":"Domino2 v0.2.1","what":"Plotting functions","title":"Version 0.2","text":"Circos plot ligand expression targeting specified receptor chord widths correspond quantity ligand expression cell cluster Signaling networks showing outgoing signaling specified cell clusters Gene networks two cell clusters","code":""},{"path":"/news/news-0.2.html","id":"bugfixes-0-2-1","dir":"News","previous_headings":"Domino2 v0.2.1","what":"Bugfixes","title":"Version 0.2","text":"Added host option gene ortholog conversions using biomart access maintained mirrors Transcription factor-target linkages now properly stored receptors transcription factor’s regulon excluded linkage Ligand nodes sizes gene networks correspond quantity ligand expression create_domino can run without providing regulon list References host GitHub repository updated “Elisseeff-Lab”","code":""},{"path":"/old.README.html","id":null,"dir":"","previous_headings":"","what":"Domino2","title":"Domino2","text":"Domino2 tool analysis intra- intercellular signaling single cell RNA sequencing data based transcription factor activation ligand receptor signaling.","code":""},{"path":"/old.README.html","id":"fertig-lab-development-branch","dir":"","previous_headings":"","what":"Fertig Lab Development Branch","title":"Domino2","text":"repository intended integration updates Domino2 Fertig Lab Elisseeff Lab. code may currently unstable currently recommended use. like use Domino, please use main repository hosted Elisseeff Lab https://github.com/Elisseeff-Lab/domino.","code":""},{"path":"/old.README.html","id":"branch-notes","dir":"","previous_headings":"Fertig Lab Development Branch","what":"Branch notes:","title":"Domino2","text":"Code used version Domino published 2021 archived branch domino_paper_archive. Changes, issues pull requests handled master branch easy use installation updated version. Added option use cells without receptor dropout calculating Pearson correlation.","code":""},{"path":"/old.README.html","id":"citation","dir":"","previous_headings":"Fertig Lab Development Branch","what":"Citation","title":"Domino2","text":"find Domino useful, please consider citing us. Cherry C, Maestas DR, Han J, Andorko JI, Cahan P, Fertig EJ, Garmire LX, Elisseeff JH. Computational reconstruction signalling networks surrounding implanted biomaterials single-cell transcriptomics. Nat Biomed Eng. 2021 Oct;5(10):1228-1238. doi: 10.1038/s41551-021-00770-5. Epub 2021 Aug 2. PMID: 34341534; PMCID: PMC9894531. make sure cite SCENIC use transcription factor scores. Aibar, Sara, et al. “SCENIC: single-cell regulatory network inference clustering.” Nature methods 14.11 (2017): 1083-1086.","code":""},{"path":"/old.README.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Domino2","text":"Domino can installed github repository. Domino requires ligand-receptor database. use cellphonedb. Domino look four files: complexes.csv genes.csv interactions.csv proteins.csv. like download terminal commands .","code":"if(!require(devtools)){     install.packages('devtools') } devtools::install_github('Elisseeff-Lab/domino') curl -O https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/sources/complex_curated.csv mv complex_curated.csv complexes.csv curl -O https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/sources/interaction_curated.csv mv interaction_curated.csv interactions.csv curl -O https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/sources/protein_curated.csv mv protein_curated.csv proteins.csv curl -O https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/gene_input.csv mv gene_input.csv genes.csv"},{"path":"/old.README.html","id":"setting-up-scenic","dir":"","previous_headings":"Installation","what":"Setting up SCENIC","title":"Domino2","text":"choose use SCENIC generate transcription factor activation scores, recommend Python implementation. ’s significantly faster R version SCENIC longest part analysis pipeline far. Docker/Singularity images available . tutorials, use bash script wrote run SCENIC Docker image. ’ll need set environment properly wish use script run SCENIC. First, need docker image SCENIC 0.10.0. Docker image need directory pull input files write output files . default, use ~/docker_scratch, feel free make whatever like change directory variable bash script. Put following reference files scratch folder using script. SCENIC requires list transcription factors, motif annotations, cisTarget motifs available authors SCENIC human (HGNC), mouse (MGI), fly. following download everything necessary analysis data set MGI gene labels mm9 genome. HGNC gene labels hg19 genome","code":"mkdir ~/docker_scratch curl -O https://raw.githubusercontent.com/aertslab/pySCENIC/master/resources/mm_mgi_tfs.txt curl -O https://resources.aertslab.org/cistarget/motif2tf/motifs-v9-nr.mgi-m0.001-o0.0.tbl curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-500bp-upstream-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-500bp-upstream-10species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-tss-centered-10kb-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-tss-centered-10kb-10species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-tss-centered-5kb-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-tss-centered-5kb-10species.mc9nr.feather curl -O https://raw.githubusercontent.com/aertslab/pySCENIC/master/resources/hs_hgnc_curated_tfs.txt curl -O https://resources.aertslab.org/cistarget/motif2tf/motifs-v9-nr.hgnc-m0.001-o0.0.tbl curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-500bp-upstream-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-500bp-upstream-10species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-tss-centered-10kb-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-tss-centered-10kb-10species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-tss-centered-5kb-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-tss-centered-5kb-10species.mc9nr.feather"},{"path":"/old.README.html","id":"a-complete-basic-analysis-using-domino","dir":"","previous_headings":"","what":"A complete basic analysis using Domino","title":"Domino2","text":"run complete analysis Domino picking phenotypic assignment clusters. like see example Domino without using clusters check cluster free analysis vignette . First need get data. Seurat object contains cluster assignments Seurat 2,700 PBMC tutorial. wont need install Seurat don’t already - just pulling data object. create directory put stuff well.","code":"mkdir ~/work/domino_basic_example"},{"path":"/old.README.html","id":"running-scenic","dir":"","previous_headings":"A complete basic analysis using Domino","what":"Running SCENIC","title":"Domino2","text":"first step generate transcription factor activation scores SCENIC. following along, need created Docker scratch directory downloaded necessary HGNC reference files described Setting SCENIC section . First need write counts file Docker temporary directory R. Now simply need run SCENIC bash script data MGI symbols. data set 32-core EPYC Rome 7002 running step takes 40m. like skip step, necessary output files provided . Either way, move files working directory terminal file explorer.","code":"ser = readRDS('pbmc3k_final.rds') write.table(t(as.matrix(ser@assays$RNA@counts)), '~/docker_scratch/counts.tsv',      sep = '\\t', col.names = NA) bash ~/my_software/domino/scenic_bash/hgnc_scenic.sh mv ~/docker_scratch/auc_mtx.csv ~/work/domino_basic_example mv ~/docker_scratch/regulons.csv ~/work/domino_basic_example"},{"path":"/old.README.html","id":"creating-the-domino-object","dir":"","previous_headings":"A complete basic analysis using Domino","what":"Creating the domino object","title":"Domino2","text":"Now SCENIC data can run domino. example’s sake, pull necessary information Seurat object first can also simply provide Seurat object create_domino function pull . also read AUC matrix SCENIC. Note must transposed SCENIC’s output. command generates domino object prepares (compiles LR database, calculates cluster TF enrichment, calculates TF - R correlation). Make sure put correct directory cellphonedb data sets .","code":"library(domino) ser = readRDS('pbmc3k_final.rds') counts = ser@assays$RNA@counts z_scores = ser@assays$RNA@scale.data clusters = ser@active.ident auc = t(read.table('auc_mtx.csv', header = TRUE, row.names = 1,      stringsAsFactors = FALSE, sep = ',')) pbmc_dom = create_domino(signaling_db = '~/work/ref/human/cpdb/',      features = auc, counts = counts, z_scores = z_scores, clusters = clusters,      df = 'regulons.csv')"},{"path":"/old.README.html","id":"building-the-signaling-network-and-plotting-options","dir":"","previous_headings":"A complete basic analysis using Domino","what":"Building the signaling network and plotting options","title":"Domino2","text":"four major parameters can play buidling signaling network, two selecting TFs cluster two connecting TFs recs. min_tf_pval minimum p val TF assigned cluster max_tf_per_clust maximum number transcription factors allowed cluster. patter true rec_tf_cor_threshold max_rec_per_tf except thresholding Pearon correlation receptor transcription factor. Building signaling network takes little time feel free play around values. general prefer select pval cor threshold good portion TFs recs trimmed maximum number thresholds. Now just need visualize signaling network. First, visualize cluster-cluster signaling signaling_network. using max threshold (max_thresh) Mk cluster’s expression ITGA2B much higher clusters/ligands drowns relevant signaling . Give shot without max_thresh ’ll see mean. Intercluster signaling network default, nodes scaled based expression ligands targetting . larger cells data set expressing high amounts ligands targetting cluster. edges weighted based strength signaling two specific clusters. color edge match color ligand cluster. example, network teal line connecting CD8 T cells DCs represents signaling T cells DCs. order determine ligand-receptor-TF signaling patterns involved , can zoom gene network DCs. DC gene network default red nodes ligands, blue receptors, green transcription factors. Now lets look expression ligands targetting DCs. DC incoming signaling heatmap looks like CCL5 major component signaling T cells DCs. gene network looks like CCL5 predicted target LILRB1 activate IRF4 IRF8 DCs. can investigate expression patterns associated linkages. First, lets generate heatmap transcription factor activation scores. Transcription factor activation score heatmap look connections transcription factors receptores can create heatmap correlations two. Rec-TF correlation heatmap Finally, can visualize entire tf-r-l network including clusters gene_network. Note function return igraph object used make plot. important use force directed layout like make two versions plot. use default settings allow us see node labels reformat plot igraph options make less cluttered smaller formats.  Thanks taking look software. questions please let us know .","code":"pbmc_dom = build_domino(pbmc_dom, max_tf_per_clust = 10,      min_tf_pval = .001, max_rec_per_tf = 10, rec_tf_cor_threshold = .25) signaling_network(pbmc_dom, edge_weight = .5, max_thresh = 2.5) gene_network(pbmc_dom, clust = 'DC', layout = 'fr') incoming_signaling_heatmap(pbmc_dom, rec_clust = 'DC', max_thresh = 2.5) feat_heatmap(pbmc_dom, norm = TRUE, bool = FALSE) cor_heatmap(pbmc_dom, bool = FALSE, mark_connections = TRUE) info = gene_network(pbmc_dom, clust = levels(pbmc_dom@clusters),      lig_scale = FALSE, layout = 'fr') plot(info$graph, layout = info$layout, vertex.size = 3, edge.color = 'grey',      vertex.frame.color = 'black', vertex.label = NA)"},{"path":"/reference/add_rl_column.html","id":null,"dir":"Reference","previous_headings":"","what":"Adds a column to the RL signaling data frame. — add_rl_column","title":"Adds a column to the RL signaling data frame. — add_rl_column","text":"function adds column internal rl 'map' used map  receptor receptor complexes ligand ligand complexes.","code":""},{"path":"/reference/add_rl_column.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adds a column to the RL signaling data frame. — add_rl_column","text":"","code":"add_rl_column(map, map_ref, conv, new_name)"},{"path":"/reference/add_rl_column.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adds a column to the RL signaling data frame. — add_rl_column","text":"map RL signaling data frame. map_ref Name column match new data conv Data frame matching current data map new data. new_name Name new column created RL map","code":""},{"path":"/reference/add_rl_column.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adds a column to the RL signaling data frame. — add_rl_column","text":"RL signaling data frame.","code":""},{"path":"/reference/build_domino.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a signaling network for a domino object — build_domino","title":"Calculate a signaling network for a domino object — build_domino","text":"function calculates signaling network. requires domino object preprocessed create_domino returns domino object prepared  plotting various plotting functions package.","code":""},{"path":"/reference/build_domino.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a signaling network for a domino object — build_domino","text":"","code":"build_domino(   dom,   max_tf_per_clust = 5,   min_tf_pval = 0.01,   max_rec_per_tf = 5,   rec_tf_cor_threshold = 0.15,   min_rec_percentage = 0.1 )"},{"path":"/reference/build_domino.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a signaling network for a domino object — build_domino","text":"dom Domino object create_domino. max_rec_per_tf Maximum number receptors link transcription factor. rec_tf_cor_threshold Minimum pearson correlation used consider receptor linked transcription factor. Increasing decrease number receptors linked transcription factor. min_rec_percentage Minimum percentage cells cluster expressing receptor receptor linked trancription factors cluster.","code":""},{"path":"/reference/build_domino.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a signaling network for a domino object — build_domino","text":"domino object","code":""},{"path":"/reference/circos_ligand_receptor.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot expression of a receptor's ligands by other cell types as a circos plot — circos_ligand_receptor","title":"Plot expression of a receptor's ligands by other cell types as a circos plot — circos_ligand_receptor","text":"Creates circos plot expression ligands can activate specified receptor chord widths correspond mean ligand expression cluster.","code":""},{"path":"/reference/circos_ligand_receptor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot expression of a receptor's ligands by other cell types as a circos plot — circos_ligand_receptor","text":"","code":"circos_ligand_receptor(   dom,   receptor,   ligand_expression_threshold = 0.01,   cell_idents = NULL,   cell_colors = NULL )"},{"path":"/reference/circos_ligand_receptor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot expression of a receptor's ligands by other cell types as a circos plot — circos_ligand_receptor","text":"dom domino object undergone network building build_domino() receptor Name receptor active least one cell type domino object ligand_expression_threshold minimum mean expression value ligand cell type chord rendered cell type receptor cell_idents vector cell types cluster assignments domino object included circos plot. cell_colors named vector color names hex codes names correspond plotted cell types color values","code":""},{"path":"/reference/collate_network_items.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","title":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","text":"function collates features, receptors, ligands found signaling network anywhere list clusters. can useful comparing signaling networks across two separate conditions. order run build_domino must run object previously.","code":""},{"path":"/reference/collate_network_items.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","text":"","code":"collate_network_items(dom, clusters = NULL, return = NULL)"},{"path":"/reference/collate_network_items.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","text":"dom domino object containing signaling network (.e. build_domino run) clusters vector indicating clusters collate network items . left NULL clusters included. return string indicating collate 'features', 'receptors', 'ligands'. '' list three returned.","code":""},{"path":"/reference/collate_network_items.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","text":"vector containing features, receptors, ligands data set list containing three.","code":""},{"path":"/reference/convert_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Use biomaRt to convert genes — convert_genes","title":"Use biomaRt to convert genes — convert_genes","text":"function reads vector genes converts genes ","code":""},{"path":"/reference/convert_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use biomaRt to convert genes — convert_genes","text":"","code":"convert_genes(genes, from, to, host = \"https://www.ensembl.org\")"},{"path":"/reference/convert_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use biomaRt to convert genes — convert_genes","text":"genes Vector genes convert. Format gene input (ENSMUSG, ENSG, MGI, HGNC) Format gene output (ENSMUSG, ENSG, MGI, HGNC) host Host connect . Defaults https://www.ensembl.org following useMart default, can changed archived hosts useMart fails connect.","code":""},{"path":"/reference/convert_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use biomaRt to convert genes — convert_genes","text":"data frame input genes col 1 output col 2.","code":""},{"path":"/reference/cor_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a heatmap of correlation between receptors and transcription factors — cor_heatmap","title":"Create a heatmap of correlation between receptors and transcription factors — cor_heatmap","text":"Creates heatmap correlation values receptors transcription  factors.","code":""},{"path":"/reference/cor_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a heatmap of correlation between receptors and transcription factors — cor_heatmap","text":"","code":"cor_heatmap(   dom,   bool = TRUE,   bool_thresh = 0.15,   title = TRUE,   feats = NULL,   recs = NULL,   mark_connections = FALSE,   ... )"},{"path":"/reference/cor_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a heatmap of correlation between receptors and transcription factors — cor_heatmap","text":"dom domino object network built (build_domino) bool boolean indicating whether heatmap continuous boolean. boolean bool_thresh used determine define activity positive negative. bool_thresh numeric indicating threshold separating '' '' feature activity making boolean heatmap. title Either string use title boolean describing whether include title. order pass 'main' parameter NMF::aheatmap must set title FALSE. feats Either vector features include heatmap '' features. left NULL features selected signaling network shown. recs Either vector receptors include heatmap '' receptors. left NULL receptors selected signaling network connected features plotted shown. mark_connections boolean indicating whether add 'x' cells connected receptor TF. Default FALSE. ... parameters pass NMF::aheatmap. Note use 'main' parameter NMF::aheatmap must set title = FALSE use 'annCol' 'annColors' ann_cols must FALSE.","code":""},{"path":"/reference/cor_scatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a correlation plot between transcription factor activation score and receptor — cor_scatter","title":"Create a correlation plot between transcription factor activation score and receptor — cor_scatter","text":"Create correlation plot transcription factor activation score receptor","code":""},{"path":"/reference/cor_scatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a correlation plot between transcription factor activation score and receptor — cor_scatter","text":"","code":"cor_scatter(dom, tf, rec, remove_rec_dropout = TRUE, ...)"},{"path":"/reference/cor_scatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a correlation plot between transcription factor activation score and receptor — cor_scatter","text":"dom domino object network built (build_domino) tf Target TF module plotting receptor rec Target receptor plotting TF remove_rec_dropout Whether remove cells zero expression plot. match setting build_domino. ... parameters pass ggscatter.","code":""},{"path":"/reference/create_domino.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a domino object and prepare it for network construction — create_domino","title":"Create a domino object and prepare it for network construction — create_domino","text":"function reads receptor ligand signaling database, cell level  features kind (ie. output pySCENIC), z-scored single cell data,  cluster id single cell data, calculates correlation matrix  receptors features (transcription factor module scores  using pySCENIC), finds features enriched cluster. return  domino object prepared build_domino, calculate signaling  network.","code":""},{"path":"/reference/create_domino.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a domino object and prepare it for network construction — create_domino","text":"","code":"create_domino(   rl_map,   features,   ser = NULL,   counts = NULL,   z_scores = NULL,   clusters = NULL,   use_clusters = TRUE,   tf_targets = NULL,   verbose = TRUE,   use_complexes = TRUE,   rec_min_thresh = 0.025,   remove_rec_dropout = TRUE,   tf_selection_method = \"clusters\",   tf_variance_quantile = 0.5 )"},{"path":"/reference/create_domino.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a domino object and prepare it for network construction — create_domino","text":"rl_map data frame row describes receptor-ligand interaction required columns gene_A & gene_B including gene names receptor ligand type_A & type_B annotating genes B ligand (L) receptor (R) features Either path csv containing cell level features interest (ie. auc matrix pySCENIC) named matrix cells columns features rows. ser Seurat object containing scaled RNA expression data RNA assay slot cluster identity. Either ser object z_scores clusters must provided. ser present z_scores clusters ignored. counts counts matrix data. Seurat object provided ignored. used threshold receptors dropout. z_scores matrix containing z-scored expression data cells cells columns features rows. Either z_scores clusters must provided ser object. ser present z_scores clusters ignored. clusters named factor containing cell cluster names cells. Either clusters z_scores ser must provided. ser present z_scores clusters ignored. use_clusters Boolean indicating whether use clusters Seurat object. Seurat object provided parameter ignored. tf_targets Optional. list names transcription factors stored values character vectors genes transcription factor's regulon. verbose Boolean indicating whether print progress computation. use_complexes Boolean indicating whether wish use receptor/ligand complexes receptor ligand signaling database. FALSE, receptor/ligand pairs either functions protein complex considered constructing signaling network. rec_min_thresh Minimum expression level receptors cell. Default 0.025 2.5 percent cells data set. important calculating correlation connect receptors transcription activation. threshold low correlation calculations proceed cells non-zero expression. remove_rec_dropout Whether remove receptors 0 expression counts calculating correlations. can reduce false positive correlation calculations receptors high dropout rates. tf_selection_method Selection method target transcription factors. 'clusters' differential expression clusters calculated. 'variable' variable transcription factors selected. '' transcription factors feature matrix used. Default 'clusters'. Note wish use clusters intercellular signaling downstream MUST choose clusters. tf_variance_quantile proportion variable features take using variance threshold features. Default 0.5. Higher numbers keep features. Ignored tf_selection_method 'variable'","code":""},{"path":"/reference/create_domino.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a domino object and prepare it for network construction — create_domino","text":"domino object.","code":""},{"path":"/reference/create_regulon_list_scenic.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","title":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","text":"Generates list transcription factors genes targeted transcription factor part regulon inferred pySCENIC","code":""},{"path":"/reference/create_regulon_list_scenic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","text":"","code":"create_regulon_list_scenic(regulons)"},{"path":"/reference/create_regulon_list_scenic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","text":"regulons dataframe file path table output grn (gene regulatory network) function pySCENIC","code":""},{"path":"/reference/create_regulon_list_scenic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","text":"List names transcription factors stored values character vectors genes inferred regulons","code":""},{"path":"/reference/create_rl_map_cellphonedb.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","title":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","text":"Generates data frame ligand-receptor interactions CellPhoneDB database annotating genes encoding interacting ligands receptors queried transcriptomic data.","code":""},{"path":"/reference/create_rl_map_cellphonedb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","text":"","code":"create_rl_map_cellphonedb(   genes,   proteins,   interactions,   complexes = NULL,   database_name = \"CellPhoneDB\",   gene_conv = NULL,   gene_conv_host = \"https://www.ensembl.org\" )"},{"path":"/reference/create_rl_map_cellphonedb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","text":"genes dataframe file path table gene names uniprot, hgnc_symbol, ensembl format cellphonedb database format proteins dataframe file path table protein features cellphonedb format interactions dataframe file path table protein-protein interactions cellphonedb format complexes optional: dataframe file path table protein complexes cellphonedb format","code":""},{"path":"/reference/create_rl_map_cellphonedb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","text":"Data frame row describes possible receptor-ligand interaction","code":""},{"path":"/reference/do_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize a matrix to its max value by row or column — do_norm","title":"Normalize a matrix to its max value by row or column — do_norm","text":"Normalizes matrix max value row column","code":""},{"path":"/reference/do_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize a matrix to its max value by row or column — do_norm","text":"","code":"do_norm(mat, dir)"},{"path":"/reference/do_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize a matrix to its max value by row or column — do_norm","text":"mat matrix normalized dir direction normalize matrix c('row', 'col')","code":""},{"path":"/reference/do_norm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize a matrix to its max value by row or column — do_norm","text":"Normalized matrix direction specified.","code":""},{"path":"/reference/domino-class.html","id":null,"dir":"Reference","previous_headings":"","what":"The domino Class — domino-class","title":"The domino Class — domino-class","text":"domino class contains information necessary calculate receptor ligand signaling. contains z scored expression, cluster, feature values, formatted receptor ligand databases well calculated  intermediates.","code":""},{"path":"/reference/domino-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"The domino Class — domino-class","text":"db_info List data sets lr database. counts Raw count gene expression data z_scores Matrix z-scored expression data cells columns clusters Named factor cluster identity cell features Matrix features correlate receptor-ligand expression . Cells columns features rows. df List containing transcriptional targets transcription factor. cor Correlation matrix receptor expression features. linkages List lists containing info linking cluster->tf->rec->lig clust_de Data frame containing differential expression results features cluster. misc List miscellaneous info pertaining run parameters etc. cl_signaling_matrices Incoming signaling matrix cluster signaling Signaling matrix clusters.","code":""},{"path":"/reference/feat_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a heatmap of features organized by cluster — feat_heatmap","title":"Create a heatmap of features organized by cluster — feat_heatmap","text":"Creates heatmap feature expression (typically transcription factor activation scores) cells organized cluster.","code":""},{"path":"/reference/feat_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a heatmap of features organized by cluster — feat_heatmap","text":"","code":"feat_heatmap(   dom,   feats = NULL,   bool = TRUE,   bool_thresh = 0.2,   title = TRUE,   norm = FALSE,   cols = NULL,   ann_cols = TRUE,   min_thresh = NULL,   max_thresh = NULL,   ... )"},{"path":"/reference/feat_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a heatmap of features organized by cluster — feat_heatmap","text":"dom domino object network built (build_domino) feats Either vector features include heatmap '' features. left NULL features selected signaling network shown. bool boolean indicating whether heatmap continuous boolean. boolean bool_thresh used determine define activity positive negative. bool_thresh numeric indicating threshold separating '' '' feature activity making boolean heatmap. title Either string use title boolean describing whether include title. order pass 'main' parameter NMF::aheatmap must set title FALSE. norm Boolean indicating whether normalize transcrption factors max value. cols named vector colors annotate cells cluster color. Values taken colors names cluster. left NULL default ggplot colors generated. ann_cols Boolean indicating whether include cell cluster column annotation. Colors can defined cols. FALSE custom annotations can passed NMF. min_thresh Minimum threshold color scaling boolean heatmap max_thresh Maximum threshold color scaling boolean heatmap ... parameters pass NMF::aheatmap. Note use 'main' parameter NMF::aheatmap must set title = FALSE use 'annCol' 'annColors' ann_cols must FALSE.","code":""},{"path":"/reference/gene_network.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a gene association network — gene_network","title":"Creates a gene association network — gene_network","text":"Creates gene association network genes given cluster.  selected cluster acts receptor gene association network, ligands, receptors, features associated receptor cluster included plot.","code":""},{"path":"/reference/gene_network.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a gene association network — gene_network","text":"","code":"gene_network(   dom,   clust = NULL,   OutgoingSignalingClust = NULL,   class_cols = c(lig = \"#FF685F\", rec = \"#47a7ff\", feat = \"#39C740\"),   cols = NULL,   lig_scale = 1,   layout = \"grid\",   ... )"},{"path":"/reference/gene_network.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a gene association network — gene_network","text":"dom domino object network built (build_domino) clust receptor cluster create gene association network . vector clusters may provided. OutgoingSignalingClust vector clusters plot outgoing signaling class_cols named vector colors used color classes vertices. Values must colors names must classes ('rec', 'lig', 'feat' receptors, ligands, features.). cols named vector colors individual genes. Genes included vector colored according class_cols. lig_scale FALSE numeric value scale size ligand vertices based z-scored expression data set. layout Type layout use. Options 'grid', 'random', 'sphere', 'circle', 'fr' Fruchterman-Reingold force directed layout, 'kk' Kamada Kawai directed layout. ... parameters pass plot() igraph object. See igraph manual options.","code":""},{"path":"/reference/ggplot_col_gen.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate ggplot colors — ggplot_col_gen","title":"Generate ggplot colors — ggplot_col_gen","text":"Accepts number colors generate generates ggplot color spectrum.","code":""},{"path":"/reference/ggplot_col_gen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate ggplot colors — ggplot_col_gen","text":"","code":"ggplot_col_gen(n)"},{"path":"/reference/ggplot_col_gen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate ggplot colors — ggplot_col_gen","text":"n Number colors generate","code":""},{"path":"/reference/ggplot_col_gen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate ggplot colors — ggplot_col_gen","text":"vector colors according ggplot color generation.","code":""},{"path":"/reference/incoming_signaling_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a cluster incoming signaling heatmap — incoming_signaling_heatmap","title":"Create a cluster incoming signaling heatmap — incoming_signaling_heatmap","text":"Creates heatmap cluster incoming signaling matrix. cluster list ligands capable activating enriched transcription factors. function creates heatmap cluster average expression  ligands. list cluster incoming signaling matrices can found cl_signaling_matrices slot domino option alternative plotting function.","code":""},{"path":"/reference/incoming_signaling_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a cluster incoming signaling heatmap — incoming_signaling_heatmap","text":"","code":"incoming_signaling_heatmap(   dom,   rec_clust,   clusts = NULL,   min_thresh = -Inf,   max_thresh = Inf,   scale = \"none\",   normalize = \"none\",   title = TRUE,   ... )"},{"path":"/reference/incoming_signaling_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a cluster incoming signaling heatmap — incoming_signaling_heatmap","text":"dom domino object network built (build_domino) rec_clust cluster select receptor. Must match naming clusters domino object. clusts vector clusters included. NULL clusters used. min_thresh Minimum signaling threshold plotting. Defaults -Inf threshold. max_thresh Maximum signaling threshold plotting. Defaults Inf threshold. scale scale values (thresholding). Options 'none', 'sqrt' square root, 'log' log10. normalize Options normalize matrix. Accepted inputs 'none' normalization, 'rec_norm' normalize maximum value receptor cluster, 'lig_norm' normalize maximum value within ligand cluster title Either string use title boolean describing whether include title. order pass 'main' parameter NMF::aheatmap must set title FALSE. ... parameters pass NMF::aheatmap. Note use 'main' parameter NMF::aheatmap must set title = FALSE","code":""},{"path":"/reference/lc.html","id":null,"dir":"Reference","previous_headings":"","what":"Pulls all items from a list pooled into a single vector — lc","title":"Pulls all items from a list pooled into a single vector — lc","text":"Helper function convert nested series lists single vector.","code":""},{"path":"/reference/lc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pulls all items from a list pooled into a single vector — lc","text":"","code":"lc(list, list_names)"},{"path":"/reference/lc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pulls all items from a list pooled into a single vector — lc","text":"list List pull items list_names Names items list pool","code":""},{"path":"/reference/lc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pulls all items from a list pooled into a single vector — lc","text":"vector contaning items list list_names.","code":""},{"path":"/reference/mean_ligand_expression.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","title":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","text":"Creates data frame mean ligand expression use plotting circos plot ligand exression saving tables mean expression.","code":""},{"path":"/reference/mean_ligand_expression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","text":"","code":"mean_ligand_expression(x, ligands, cell_ident, cell_barcodes, destination)"},{"path":"/reference/mean_ligand_expression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","text":"x gene cell expression matrix ligands character vector ligand genes quantified cell_ident vector cell type (identity) names calculate mean ligand gene expression cell_barcodes vector cell barcodes (colnames x) belonging cell_ident calculate mean expression across destination name receptor ligand interacts","code":""},{"path":"/reference/mean_ligand_expression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","text":"data frame ligand expression targeting specified receptor","code":""},{"path":"/reference/rename_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Renames clusters in a domino object — rename_clusters","title":"Renames clusters in a domino object — rename_clusters","text":"function reads receptor ligand signaling database, cell level  features kind (ie. output pySCENIC), z-scored single cell data,  cluster id single cell data, calculates correlation matrix  receptors features (transcription factor module scores  using pySCENIC), finds features enriched cluster. return  domino object prepared build_domino, calculate signaling  network.","code":""},{"path":"/reference/rename_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Renames clusters in a domino object — rename_clusters","text":"","code":"rename_clusters(dom, clust_conv)"},{"path":"/reference/rename_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Renames clusters in a domino object — rename_clusters","text":"dom domino object rename clusters clust_conv named vector conversions old new clusters. Values taken new clusters IDs names old cluster IDs.","code":""},{"path":"/reference/rename_clusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Renames clusters in a domino object — rename_clusters","text":"domino object clusters renamed applicable slots.","code":""},{"path":"/reference/signaling_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a network heatmap — signaling_heatmap","title":"Create a network heatmap — signaling_heatmap","text":"Creates heatmap signaling network. Alternatively, network  matrix can accessed directly signaling slot domino object.","code":""},{"path":"/reference/signaling_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a network heatmap — signaling_heatmap","text":"","code":"signaling_heatmap(   dom,   clusts = NULL,   min_thresh = -Inf,   max_thresh = Inf,   scale = \"none\",   normalize = \"none\",   ... )"},{"path":"/reference/signaling_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a network heatmap — signaling_heatmap","text":"dom domino object network built (build_domino) clusts vector clusters included. NULL clusters used. min_thresh Minimum signaling threshold plotting. Defaults -Inf threshold. max_thresh Maximum signaling threshold plotting. Defaults Inf threshold. scale scale values (thresholding). Options 'none', 'sqrt' square root, 'log' log10. normalize Options normalize matrix. Normalization done thresholding scaling. Accepted inputs 'none' normalization, 'rec_norm' normalize maximum value receptor cluster, 'lig_norm' normalize maximum value within ligand cluster ... parameters pass NMF::aheatmap","code":""},{"path":"/reference/signaling_network.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a cluster to cluster signaling network diagram — signaling_network","title":"Create a cluster to cluster signaling network diagram — signaling_network","text":"Creates network diagram signaling clusters. Nodes clusters directed edges indicate signaling one cluster another. Edges colored based color scheme ligand expressing cluster.","code":""},{"path":"/reference/signaling_network.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a cluster to cluster signaling network diagram — signaling_network","text":"","code":"signaling_network(   dom,   cols = NULL,   edge_weight = 0.3,   clusts = NULL,   showOutgoingSignalingClusts = NULL,   showIncomingSignalingClusts = NULL,   min_thresh = -Inf,   max_thresh = Inf,   normalize = \"none\",   scale = \"sq\",   layout = \"circle\",   scale_by = \"rec_sig\",   vert_scale = 3,   plot_title = NULL,   ... )"},{"path":"/reference/signaling_network.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a cluster to cluster signaling network diagram — signaling_network","text":"dom domino object network built (build_domino) cols named vector indicating colors clusters. Values colors names must match clusters domino object. left NULL ggplot colors generated clusters. edge_weight Weight determining thickness edges plot. Signaling values multiplied value. clusts vector clusters included network plot. showOutgoingSignalingClusts vector clusters plot outgoing signaling showIncomingSignalingClusts vector clusters plot incoming signaling min_thresh Minimum signaling threshold. Values lower threshold set threshold. Defaults -Inf threshold. max_thresh Maximum signaling threshold plotting. Values higher threshold set threshold. Defaults Inf threshold. normalize Options normalize signaling matrix. Accepted inputs 'none' normalization, 'rec_norm' normalize maximum value receptor cluster, 'lig_norm' normalize maximum value within ligand cluster scale scale values (thresholding). Options 'none', 'sqrt' square root, 'log' log10, 'sq' square. layout Type layout use. Options 'random', 'sphere', 'circle', 'fr' Fruchterman-Reingold force directed layout, 'kk' Kamada Kawai directed layout. scale_by size vertices. Options 'lig_sig' summed outgoing signaling, 'rec_sig' summed incoming signaling, 'none'. former two cases values scaled asinh summing incoming outgoing signaling. vert_scale Integer used scale size vertices without variable scaling size_verts_by. ... parameters passed plot used igraph object.","code":""}]
