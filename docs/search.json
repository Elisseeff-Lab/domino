[{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Christopher Cherry. Author, maintainer. Jacob T Mitchell. Author. Sushma Nagaraj. Author. Elana Fertig. Contributor. Jennifer Elisseeff. Contributor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Cherry C, Mitchell JT, Nagaraj S (2023). domino2: Receptor Ligand Analysis Single Cell RNA Seq. R package version 0.2.1.","code":"@Manual{,   title = {domino2: Receptor Ligand Analysis for Single Cell RNA Seq},   author = {Christopher Cherry and Jacob T Mitchell and Sushma Nagaraj},   year = {2023},   note = {R package version 0.2.1}, }"},{"path":"/index.html","id":"domino2","dir":"","previous_headings":"","what":"Receptor Ligand Analysis for Single Cell RNA Seq","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"Domino2 tool analysis intra- intercellular signaling single cell RNA seq based transcription factor activation.","code":""},{"path":"/index.html","id":"fertig-lab-development-branch","dir":"","previous_headings":"","what":"Fertig Lab Development Branch","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"repository intended integration updates Domino2 Fertig Lab Elisseeff Lab. code may currently unstable currently recommended use. like use Domino, please use main repository hosted Elisseeff Lab https://github.com/Elisseeff-Lab/domino.","code":""},{"path":"/index.html","id":"branch-notes","dir":"","previous_headings":"Fertig Lab Development Branch","what":"Branch notes:","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"Code used version Domino published 2021 archived branch domino_paper_archive. Changes, issues pull requests handled master branch easy use installation updated version.","code":""},{"path":"/index.html","id":"update-notes-for-v02","dir":"","previous_headings":"Fertig Lab Development Branch","what":"Update notes for v0.2","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"Updates domino object construction - Uniform formats inputs receptor-ligand interaction databases, tf activity features, regulon gene lists operability alternative databases tf activity inference methods - Helper functions reformatting pySCENIC outputs CellPhoneDB database files domino-readable uniform formats - Assessment transcription factor linkage receptors function heteromeric complex based correlation transcription factor activity receptor component genes - Assessment complex ligand expression mean component gene expression plotting functions - Minimum threshold percentage cells cluster expressing receptor gene receptor called active within cluster - Additional linkage slots active receptors cluster, transcription factor-receptor linkages cluster, incoming ligands active receptors cluster Plotting functions - Circos plot ligand expression targeting specified receptor chord widths correspond quantity ligand expression cell cluster - Signaling networks showing outgoing signaling specified cell clusters - Gene networks two cell clusters Bugfixes - Added host option gene ortholog conversions using biomart access maintained mirrors - Transcription factor-target linkages now properly stored receptors transcription factor’s regulon excluded linkage - Ligand nodes sizes gene networks correspond quantity ligand expression - create_domino can run without providing regulon list - References host GitHub repository updated “Elisseeff-Lab” Added option use cells without receptor dropout calculating Pearson correlation.","code":""},{"path":"/index.html","id":"citation","dir":"","previous_headings":"Fertig Lab Development Branch","what":"Citation","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"find Domino useful, please consider citing us. Cherry C, Maestas DR, Han J, Andorko JI, Cahan P, Fertig EJ, Garmire LX, Elisseeff JH. Computational reconstruction signalling networks surrounding implanted biomaterials single-cell transcriptomics. Nat Biomed Eng. 2021 Oct;5(10):1228-1238. doi: 10.1038/s41551-021-00770-5. Epub 2021 Aug 2. PMID: 34341534; PMCID: PMC9894531. make sure cite SCENIC use transcription factor scores. Aibar, Sara, et al. “SCENIC: single-cell regulatory network inference clustering.” Nature methods 14.11 (2017): 1083-1086.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"Domino can installed github repository. Domino requires ligand-receptor database. use cellphonedb. Domino look four files: complexes.csv genes.csv interactions.csv proteins.csv. like download terminal commands .","code":"if(!require(devtools)){     install.packages('devtools') } devtools::install_github('Elisseeff-Lab/domino') curl -O https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/sources/complex_curated.csv mv complex_curated.csv complexes.csv curl -O https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/sources/interaction_curated.csv mv interaction_curated.csv interactions.csv curl -O https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/sources/protein_curated.csv mv protein_curated.csv proteins.csv curl -O https://raw.githubusercontent.com/Teichlab/cellphonedb-data/master/data/gene_input.csv mv gene_input.csv genes.csv"},{"path":"/index.html","id":"setting-up-scenic","dir":"","previous_headings":"Installation","what":"Setting up SCENIC","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"choose use SCENIC generate transcription factor activation scores, recommend Python implementation. ’s significantly faster R version SCENIC longest part analysis pipeline far. Docker/Singularity images available . tutorials, use bash script wrote run SCENIC Docker image. ’ll need set environment properly wish use script run SCENIC. First, need docker image SCENIC 0.10.0. Docker image need directory pull input files write output files . default, use ~/docker_scratch, feel free make whatever like change directory variable bash script. Put following reference files scratch folder using script. SCENIC requires list transcription factors, motif annotations, cisTarget motifs available authors SCENIC human (HGNC), mouse (MGI), fly. following download everything necessary analysis data set MGI gene labels mm9 genome. HGNC gene labels hg19 genome","code":"mkdir ~/docker_scratch curl -O https://raw.githubusercontent.com/aertslab/pySCENIC/master/resources/mm_mgi_tfs.txt curl -O https://resources.aertslab.org/cistarget/motif2tf/motifs-v9-nr.mgi-m0.001-o0.0.tbl curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-500bp-upstream-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-500bp-upstream-10species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-tss-centered-10kb-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-tss-centered-10kb-10species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-tss-centered-5kb-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/mus_musculus/mm9/refseq_r45/mc9nr/gene_based/mm9-tss-centered-5kb-10species.mc9nr.feather curl -O https://raw.githubusercontent.com/aertslab/pySCENIC/master/resources/hs_hgnc_curated_tfs.txt curl -O https://resources.aertslab.org/cistarget/motif2tf/motifs-v9-nr.hgnc-m0.001-o0.0.tbl curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-500bp-upstream-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-500bp-upstream-10species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-tss-centered-10kb-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-tss-centered-10kb-10species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-tss-centered-5kb-7species.mc9nr.feather curl -O https://resources.aertslab.org/cistarget/databases/homo_sapiens/hg19/refseq_r45/mc9nr/gene_based/hg19-tss-centered-5kb-10species.mc9nr.feather"},{"path":"/index.html","id":"a-complete-basic-analysis-using-domino","dir":"","previous_headings":"","what":"A complete basic analysis using Domino","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"run complete analysis Domino picking phenotypic assignment clusters. like see example Domino without using clusters check cluster free analysis vignette . First need get data. Seurat object contains cluster assignments Seurat 2,700 PBMC tutorial. wont need install Seurat don’t already - just pulling data object. create directory put stuff well.","code":"mkdir ~/work/domino_basic_example"},{"path":"/index.html","id":"running-scenic","dir":"","previous_headings":"A complete basic analysis using Domino","what":"Running SCENIC","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"first step generate transcription factor activation scores SCENIC. following along, need created Docker scratch directory downloaded necessary HGNC reference files described Setting SCENIC section . First need write counts file Docker temporary directory R. Now simply need run SCENIC bash script data MGI symbols. data set 32-core EPYC Rome 7002 running step takes 40m. like skip step, necessary output files provided . Either way, move files working directory terminal file explorer.","code":"ser = readRDS('pbmc3k_final.rds') write.table(t(as.matrix(ser@assays$RNA@counts)), '~/docker_scratch/counts.tsv',      sep = '\\t', col.names = NA) bash ~/my_software/domino/scenic_bash/hgnc_scenic.sh mv ~/docker_scratch/auc_mtx.csv ~/work/domino_basic_example mv ~/docker_scratch/regulons.csv ~/work/domino_basic_example"},{"path":"/index.html","id":"creating-the-domino-object","dir":"","previous_headings":"A complete basic analysis using Domino","what":"Creating the domino object","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"Now SCENIC data can run domino. example’s sake, pull necessary information Seurat object first can also simply provide Seurat object create_domino function pull . also read AUC matrix SCENIC. Note must transposed SCENIC’s output. command generates domino object prepares (compiles LR database, calculates cluster TF enrichment, calculates TF - R correlation). Make sure put correct directory cellphonedb data sets .","code":"library(domino) ser = readRDS('pbmc3k_final.rds') counts = ser@assays$RNA@counts z_scores = ser@assays$RNA@scale.data clusters = ser@active.ident auc = t(read.table('auc_mtx.csv', header = TRUE, row.names = 1,      stringsAsFactors = FALSE, sep = ',')) pbmc_dom = create_domino(signaling_db = '~/work/ref/human/cpdb/',      features = auc, counts = counts, z_scores = z_scores, clusters = clusters,      df = 'regulons.csv')"},{"path":"/index.html","id":"building-the-signaling-network-and-plotting-options","dir":"","previous_headings":"A complete basic analysis using Domino","what":"Building the signaling network and plotting options","title":"Receptor Ligand Analysis for Single Cell RNA Seq","text":"four major parameters can play buidling signaling network, two selecting TFs cluster two connecting TFs recs. min_tf_pval minimum p val TF assigned cluster max_tf_per_clust maximum number transcription factors allowed cluster. patter true rec_tf_cor_threshold max_rec_per_tf except thresholding Pearon correlation receptor transcription factor. Building signaling network takes little time feel free play around values. general prefer select pval cor threshold good portion TFs recs trimmed maximum number thresholds. Now just need visualize signaling network. First, visualize cluster-cluster signaling signaling_network. using max threshold (max_thresh) Mk cluster’s expression ITGA2B much higher clusters/ligands drowns relevant signaling . Give shot without max_thresh ’ll see mean. Intercluster signaling network default, nodes scaled based expression ligands targetting . larger cells data set expressing high amounts ligands targetting cluster. edges weighted based strength signaling two specific clusters. color edge match color ligand cluster. example, network teal line connecting CD8 T cells DCs represents signaling T cells DCs. order determine ligand-receptor-TF signaling patterns involved , can zoom gene network DCs. DC gene network default red nodes ligands, blue receptors, green transcription factors. Now lets look expression ligands targetting DCs. DC incoming signaling heatmap looks like CCL5 major component signaling T cells DCs. gene network looks like CCL5 predicted target LILRB1 activate IRF4 IRF8 DCs. can investigate expression patterns associated linkages. First, lets generate heatmap transcription factor activation scores. Transcription factor activation score heatmap look connections transcription factors receptores can create heatmap correlations two. Rec-TF correlation heatmap Finally, can visualize entire tf-r-l network including clusters gene_network. Note function return igraph object used make plot. important use force directed layout like make two versions plot. use default settings allow us see node labels reformat plot igraph options make less cluttered smaller formats.  Thanks taking look software. questions please let us know .","code":"pbmc_dom = build_domino(pbmc_dom, max_tf_per_clust = 10,      min_tf_pval = .001, max_rec_per_tf = 10, rec_tf_cor_threshold = .25) signaling_network(pbmc_dom, edge_weight = .5, max_thresh = 2.5) gene_network(pbmc_dom, clust = 'DC', layout = 'fr') incoming_signaling_heatmap(pbmc_dom, rec_clust = 'DC', max_thresh = 2.5) feat_heatmap(pbmc_dom, norm = TRUE, bool = FALSE) cor_heatmap(pbmc_dom, bool = FALSE, mark_connections = TRUE) info = gene_network(pbmc_dom, clust = levels(pbmc_dom@clusters),      lig_scale = FALSE, layout = 'fr') plot(info$graph, layout = info$layout, vertex.size = 3, edge.color = 'grey',      vertex.frame.color = 'black', vertex.label = NA)"},{"path":"/reference/add_rl_column.html","id":null,"dir":"Reference","previous_headings":"","what":"Adds a column to the RL signaling data frame. — add_rl_column","title":"Adds a column to the RL signaling data frame. — add_rl_column","text":"function adds column internal rl 'map' used map  receptor receptor complexes ligand ligand complexes.","code":""},{"path":"/reference/add_rl_column.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adds a column to the RL signaling data frame. — add_rl_column","text":"","code":"add_rl_column(map, map_ref, conv, new_name)"},{"path":"/reference/add_rl_column.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adds a column to the RL signaling data frame. — add_rl_column","text":"map RL signaling data frame. map_ref Name column match new data conv Data frame matching current data map new data. new_name Name new column created RL map","code":""},{"path":"/reference/add_rl_column.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adds a column to the RL signaling data frame. — add_rl_column","text":"RL signaling data frame.","code":""},{"path":"/reference/build_domino.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate a signaling network for a domino object — build_domino","title":"Calculate a signaling network for a domino object — build_domino","text":"function calculates signaling network. requires domino object preprocessed create_domino returns domino object prepared  plotting various plotting functions package.","code":""},{"path":"/reference/build_domino.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate a signaling network for a domino object — build_domino","text":"","code":"build_domino(   dom,   max_tf_per_clust = 5,   min_tf_pval = 0.01,   max_rec_per_tf = 5,   rec_tf_cor_threshold = 0.15,   min_rec_percentage = 0.1 )"},{"path":"/reference/build_domino.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate a signaling network for a domino object — build_domino","text":"dom Domino object create_domino. max_rec_per_tf Maximum number receptors link transcription factor. rec_tf_cor_threshold Minimum pearson correlation used consider receptor linked transcription factor. Increasing decrease number receptors linked transcription factor. min_rec_percentage Minimum percentage cells cluster expressing receptor receptor linked trancription factors cluster.","code":""},{"path":"/reference/build_domino.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate a signaling network for a domino object — build_domino","text":"domino object","code":""},{"path":"/reference/circos_ligand_receptor.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot expression of a receptor's ligands by other cell types as a circos plot — circos_ligand_receptor","title":"Plot expression of a receptor's ligands by other cell types as a circos plot — circos_ligand_receptor","text":"Creates circos plot expression ligands can activate specified receptor chord widths correspond mean ligand expression cluster.","code":""},{"path":"/reference/circos_ligand_receptor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot expression of a receptor's ligands by other cell types as a circos plot — circos_ligand_receptor","text":"","code":"circos_ligand_receptor(   dom,   receptor,   ligand_expression_threshold = 0.01,   cell_idents = NULL,   cell_colors = NULL )"},{"path":"/reference/circos_ligand_receptor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot expression of a receptor's ligands by other cell types as a circos plot — circos_ligand_receptor","text":"dom domino object undergone network building build_domino() receptor Name receptor active least one cell type domino object ligand_expression_threshold minimum mean expression value ligand cell type chord rendered cell type receptor cell_idents vector cell types cluster assignments domino object included circos plot. cell_colors named vector color names hex codes names correspond plotted cell types color values","code":""},{"path":"/reference/collate_network_items.html","id":null,"dir":"Reference","previous_headings":"","what":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","title":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","text":"function collates features, receptors, ligands found signaling network anywhere list clusters. can useful comparing signaling networks across two separate conditions. order run build_domino must run object previously.","code":""},{"path":"/reference/collate_network_items.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","text":"","code":"collate_network_items(dom, clusters = NULL, return = NULL)"},{"path":"/reference/collate_network_items.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","text":"dom domino object containing signaling network (.e. build_domino run) clusters vector indicating clusters collate network items . left NULL clusters included. return string indicating collate 'features', 'receptors', 'ligands'. '' list three returned.","code":""},{"path":"/reference/collate_network_items.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extracts all features, receptors, or ligands present in a signaling network. — collate_network_items","text":"vector containing features, receptors, ligands data set list containing three.","code":""},{"path":"/reference/convert_genes.html","id":null,"dir":"Reference","previous_headings":"","what":"Use biomaRt to convert genes — convert_genes","title":"Use biomaRt to convert genes — convert_genes","text":"function reads vector genes converts genes ","code":""},{"path":"/reference/convert_genes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use biomaRt to convert genes — convert_genes","text":"","code":"convert_genes(genes, from, to, host = \"https://www.ensembl.org\")"},{"path":"/reference/convert_genes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use biomaRt to convert genes — convert_genes","text":"genes Vector genes convert. Format gene input (ENSMUSG, ENSG, MGI, HGNC) Format gene output (ENSMUSG, ENSG, MGI, HGNC) host Host connect . Defaults https://www.ensembl.org following useMart default, can changed archived hosts useMart fails connect.","code":""},{"path":"/reference/convert_genes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use biomaRt to convert genes — convert_genes","text":"data frame input genes col 1 output col 2.","code":""},{"path":"/reference/cor_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a heatmap of correlation between receptors and transcription factors — cor_heatmap","title":"Create a heatmap of correlation between receptors and transcription factors — cor_heatmap","text":"Creates heatmap correlation values receptors transcription  factors.","code":""},{"path":"/reference/cor_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a heatmap of correlation between receptors and transcription factors — cor_heatmap","text":"","code":"cor_heatmap(   dom,   bool = TRUE,   bool_thresh = 0.15,   title = TRUE,   feats = NULL,   recs = NULL,   mark_connections = FALSE,   ... )"},{"path":"/reference/cor_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a heatmap of correlation between receptors and transcription factors — cor_heatmap","text":"dom domino object network built (build_domino) bool boolean indicating whether heatmap continuous boolean. boolean bool_thresh used determine define activity positive negative. bool_thresh numeric indicating threshold separating '' '' feature activity making boolean heatmap. title Either string use title boolean describing whether include title. order pass 'main' parameter NMF::aheatmap must set title FALSE. feats Either vector features include heatmap '' features. left NULL features selected signaling network shown. recs Either vector receptors include heatmap '' receptors. left NULL receptors selected signaling network connected features plotted shown. mark_connections boolean indicating whether add 'x' cells connected receptor TF. Default FALSE. ... parameters pass NMF::aheatmap. Note use 'main' parameter NMF::aheatmap must set title = FALSE use 'annCol' 'annColors' ann_cols must FALSE.","code":""},{"path":"/reference/cor_scatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a correlation plot between transcription factor activation score and receptor — cor_scatter","title":"Create a correlation plot between transcription factor activation score and receptor — cor_scatter","text":"Create correlation plot transcription factor activation score receptor","code":""},{"path":"/reference/cor_scatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a correlation plot between transcription factor activation score and receptor — cor_scatter","text":"","code":"cor_scatter(dom, tf, rec, remove_rec_dropout = TRUE, ...)"},{"path":"/reference/cor_scatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a correlation plot between transcription factor activation score and receptor — cor_scatter","text":"dom domino object network built (build_domino) tf Target TF module plotting receptor rec Target receptor plotting TF remove_rec_dropout Whether remove cells zero expression plot. match setting build_domino. ... parameters pass ggscatter.","code":""},{"path":"/reference/create_domino.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a domino object and prepare it for network construction — create_domino","title":"Create a domino object and prepare it for network construction — create_domino","text":"function reads receptor ligand signaling database, cell level  features kind (ie. output pySCENIC), z-scored single cell data,  cluster id single cell data, calculates correlation matrix  receptors features (transcription factor module scores  using pySCENIC), finds features enriched cluster. return  domino object prepared build_domino, calculate signaling  network.","code":""},{"path":"/reference/create_domino.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a domino object and prepare it for network construction — create_domino","text":"","code":"create_domino(   rl_map,   features,   ser = NULL,   counts = NULL,   z_scores = NULL,   clusters = NULL,   use_clusters = TRUE,   tf_targets = NULL,   verbose = TRUE,   use_complexes = TRUE,   rec_min_thresh = 0.025,   remove_rec_dropout = TRUE,   tf_selection_method = \"clusters\",   tf_variance_quantile = 0.5 )"},{"path":"/reference/create_domino.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a domino object and prepare it for network construction — create_domino","text":"rl_map data frame row describes receptor-ligand interaction required columns gene_A & gene_B including gene names receptor ligand type_A & type_B annotating genes B ligand (L) receptor (R) features Either path csv containing cell level features interest (ie. auc matrix pySCENIC) named matrix cells columns features rows. ser Seurat object containing scaled RNA expression data RNA assay slot cluster identity. Either ser object z_scores clusters must provided. ser present z_scores clusters ignored. counts counts matrix data. Seurat object provided ignored. used threshold receptors dropout. z_scores matrix containing z-scored expression data cells cells columns features rows. Either z_scores clusters must provided ser object. ser present z_scores clusters ignored. clusters named factor containing cell cluster names cells. Either clusters z_scores ser must provided. ser present z_scores clusters ignored. use_clusters Boolean indicating whether use clusters Seurat object. Seurat object provided parameter ignored. tf_targets Optional. list names transcription factors stored values character vectors genes transcription factor's regulon. verbose Boolean indicating whether print progress computation. use_complexes Boolean indicating whether wish use receptor/ligand complexes receptor ligand signaling database. FALSE, receptor/ligand pairs either functions protein complex considered constructing signaling network. rec_min_thresh Minimum expression level receptors cell. Default 0.025 2.5 percent cells data set. important calculating correlation connect receptors transcription activation. threshold low correlation calculations proceed cells non-zero expression. remove_rec_dropout Whether remove receptors 0 expression counts calculating correlations. can reduce false positive correlation calculations receptors high dropout rates. tf_selection_method Selection method target transcription factors. 'clusters' differential expression clusters calculated. 'variable' variable transcription factors selected. '' transcription factors feature matrix used. Default 'clusters'. Note wish use clusters intercellular signaling downstream MUST choose clusters. tf_variance_quantile proportion variable features take using variance threshold features. Default 0.5. Higher numbers keep features. Ignored tf_selection_method 'variable'","code":""},{"path":"/reference/create_domino.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a domino object and prepare it for network construction — create_domino","text":"domino object.","code":""},{"path":"/reference/create_regulon_list_scenic.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","title":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","text":"Generates list transcription factors genes targeted transcription factor part regulon inferred pySCENIC","code":""},{"path":"/reference/create_regulon_list_scenic.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","text":"","code":"create_regulon_list_scenic(regulons)"},{"path":"/reference/create_regulon_list_scenic.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","text":"regulons dataframe file path table output grn (gene regulatory network) function pySCENIC","code":""},{"path":"/reference/create_regulon_list_scenic.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a list of genes in regulons inferred by SCENIC — create_regulon_list_scenic","text":"List names transcription factors stored values character vectors genes inferred regulons","code":""},{"path":"/reference/create_rl_map_cellphonedb.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","title":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","text":"Generates data frame ligand-receptor interactions CellPhoneDB database annotating genes encoding interacting ligands receptors queried transcriptomic data.","code":""},{"path":"/reference/create_rl_map_cellphonedb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","text":"","code":"create_rl_map_cellphonedb(   genes,   proteins,   interactions,   complexes = NULL,   database_name = \"CellPhoneDB\",   gene_conv = NULL,   gene_conv_host = \"https://www.ensembl.org\" )"},{"path":"/reference/create_rl_map_cellphonedb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","text":"genes dataframe file path table gene names uniprot, hgnc_symbol, ensembl format cellphonedb database format proteins dataframe file path table protein features cellphonedb format interactions dataframe file path table protein-protein interactions cellphonedb format complexes optional: dataframe file path table protein complexes cellphonedb format","code":""},{"path":"/reference/create_rl_map_cellphonedb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a receptor-ligand map from a cellphonedb signaling database — create_rl_map_cellphonedb","text":"Data frame row describes possible receptor-ligand interaction","code":""},{"path":"/reference/do_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize a matrix to its max value by row or column — do_norm","title":"Normalize a matrix to its max value by row or column — do_norm","text":"Normalizes matrix max value row column","code":""},{"path":"/reference/do_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize a matrix to its max value by row or column — do_norm","text":"","code":"do_norm(mat, dir)"},{"path":"/reference/do_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize a matrix to its max value by row or column — do_norm","text":"mat matrix normalized dir direction normalize matrix c('row', 'col')","code":""},{"path":"/reference/do_norm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize a matrix to its max value by row or column — do_norm","text":"Normalized matrix direction specified.","code":""},{"path":"/reference/domino-class.html","id":null,"dir":"Reference","previous_headings":"","what":"The domino Class — domino-class","title":"The domino Class — domino-class","text":"domino class contains information necessary calculate receptor ligand signaling. contains z scored expression, cluster, feature values, formatted receptor ligand databases well calculated  intermediates.","code":""},{"path":"/reference/domino-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"The domino Class — domino-class","text":"db_info List data sets lr database. counts Raw count gene expression data z_scores Matrix z-scored expression data cells columns clusters Named factor cluster identity cell features Matrix features correlate receptor-ligand expression . Cells columns features rows. df List containing transcriptional targets transcription factor. cor Correlation matrix receptor expression features. linkages List lists containing info linking cluster->tf->rec->lig clust_de Data frame containing differential expression results features cluster. misc List miscellaneous info pertaining run parameters etc. cl_signaling_matrices Incoming signaling matrix cluster signaling Signaling matrix clusters.","code":""},{"path":"/reference/feat_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a heatmap of features organized by cluster — feat_heatmap","title":"Create a heatmap of features organized by cluster — feat_heatmap","text":"Creates heatmap feature expression (typically transcription factor activation scores) cells organized cluster.","code":""},{"path":"/reference/feat_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a heatmap of features organized by cluster — feat_heatmap","text":"","code":"feat_heatmap(   dom,   feats = NULL,   bool = TRUE,   bool_thresh = 0.2,   title = TRUE,   norm = FALSE,   cols = NULL,   ann_cols = TRUE,   min_thresh = NULL,   max_thresh = NULL,   ... )"},{"path":"/reference/feat_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a heatmap of features organized by cluster — feat_heatmap","text":"dom domino object network built (build_domino) feats Either vector features include heatmap '' features. left NULL features selected signaling network shown. bool boolean indicating whether heatmap continuous boolean. boolean bool_thresh used determine define activity positive negative. bool_thresh numeric indicating threshold separating '' '' feature activity making boolean heatmap. title Either string use title boolean describing whether include title. order pass 'main' parameter NMF::aheatmap must set title FALSE. norm Boolean indicating whether normalize transcrption factors max value. cols named vector colors annotate cells cluster color. Values taken colors names cluster. left NULL default ggplot colors generated. ann_cols Boolean indicating whether include cell cluster column annotation. Colors can defined cols. FALSE custom annotations can passed NMF. min_thresh Minimum threshold color scaling boolean heatmap max_thresh Maximum threshold color scaling boolean heatmap ... parameters pass NMF::aheatmap. Note use 'main' parameter NMF::aheatmap must set title = FALSE use 'annCol' 'annColors' ann_cols must FALSE.","code":""},{"path":"/reference/gene_network.html","id":null,"dir":"Reference","previous_headings":"","what":"Creates a gene association network — gene_network","title":"Creates a gene association network — gene_network","text":"Creates gene association network genes given cluster.  selected cluster acts receptor gene association network, ligands, receptors, features associated receptor cluster included plot.","code":""},{"path":"/reference/gene_network.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Creates a gene association network — gene_network","text":"","code":"gene_network(   dom,   clust = NULL,   OutgoingSignalingClust = NULL,   class_cols = c(lig = \"#FF685F\", rec = \"#47a7ff\", feat = \"#39C740\"),   cols = NULL,   lig_scale = 1,   layout = \"grid\",   ... )"},{"path":"/reference/gene_network.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Creates a gene association network — gene_network","text":"dom domino object network built (build_domino) clust receptor cluster create gene association network . vector clusters may provided. OutgoingSignalingClust vector clusters plot outgoing signaling class_cols named vector colors used color classes vertices. Values must colors names must classes ('rec', 'lig', 'feat' receptors, ligands, features.). cols named vector colors individual genes. Genes included vector colored according class_cols. lig_scale FALSE numeric value scale size ligand vertices based z-scored expression data set. layout Type layout use. Options 'grid', 'random', 'sphere', 'circle', 'fr' Fruchterman-Reingold force directed layout, 'kk' Kamada Kawai directed layout. ... parameters pass plot() igraph object. See igraph manual options.","code":""},{"path":"/reference/ggplot_col_gen.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate ggplot colors — ggplot_col_gen","title":"Generate ggplot colors — ggplot_col_gen","text":"Accepts number colors generate generates ggplot color spectrum.","code":""},{"path":"/reference/ggplot_col_gen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate ggplot colors — ggplot_col_gen","text":"","code":"ggplot_col_gen(n)"},{"path":"/reference/ggplot_col_gen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate ggplot colors — ggplot_col_gen","text":"n Number colors generate","code":""},{"path":"/reference/ggplot_col_gen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate ggplot colors — ggplot_col_gen","text":"vector colors according ggplot color generation.","code":""},{"path":"/reference/incoming_signaling_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a cluster incoming signaling heatmap — incoming_signaling_heatmap","title":"Create a cluster incoming signaling heatmap — incoming_signaling_heatmap","text":"Creates heatmap cluster incoming signaling matrix. cluster list ligands capable activating enriched transcription factors. function creates heatmap cluster average expression  ligands. list cluster incoming signaling matrices can found cl_signaling_matrices slot domino option alternative plotting function.","code":""},{"path":"/reference/incoming_signaling_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a cluster incoming signaling heatmap — incoming_signaling_heatmap","text":"","code":"incoming_signaling_heatmap(   dom,   rec_clust,   clusts = NULL,   min_thresh = -Inf,   max_thresh = Inf,   scale = \"none\",   normalize = \"none\",   title = TRUE,   ... )"},{"path":"/reference/incoming_signaling_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a cluster incoming signaling heatmap — incoming_signaling_heatmap","text":"dom domino object network built (build_domino) rec_clust cluster select receptor. Must match naming clusters domino object. clusts vector clusters included. NULL clusters used. min_thresh Minimum signaling threshold plotting. Defaults -Inf threshold. max_thresh Maximum signaling threshold plotting. Defaults Inf threshold. scale scale values (thresholding). Options 'none', 'sqrt' square root, 'log' log10. normalize Options normalize matrix. Accepted inputs 'none' normalization, 'rec_norm' normalize maximum value receptor cluster, 'lig_norm' normalize maximum value within ligand cluster title Either string use title boolean describing whether include title. order pass 'main' parameter NMF::aheatmap must set title FALSE. ... parameters pass NMF::aheatmap. Note use 'main' parameter NMF::aheatmap must set title = FALSE","code":""},{"path":"/reference/lc.html","id":null,"dir":"Reference","previous_headings":"","what":"Pulls all items from a list pooled into a single vector — lc","title":"Pulls all items from a list pooled into a single vector — lc","text":"Helper function convert nested series lists single vector.","code":""},{"path":"/reference/lc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pulls all items from a list pooled into a single vector — lc","text":"","code":"lc(list, list_names)"},{"path":"/reference/lc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pulls all items from a list pooled into a single vector — lc","text":"list List pull items list_names Names items list pool","code":""},{"path":"/reference/lc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pulls all items from a list pooled into a single vector — lc","text":"vector contaning items list list_names.","code":""},{"path":"/reference/mean_ligand_expression.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","title":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","text":"Creates data frame mean ligand expression use plotting circos plot ligand exression saving tables mean expression.","code":""},{"path":"/reference/mean_ligand_expression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","text":"","code":"mean_ligand_expression(x, ligands, cell_ident, cell_barcodes, destination)"},{"path":"/reference/mean_ligand_expression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","text":"x gene cell expression matrix ligands character vector ligand genes quantified cell_ident vector cell type (identity) names calculate mean ligand gene expression cell_barcodes vector cell barcodes (colnames x) belonging cell_ident calculate mean expression across destination name receptor ligand interacts","code":""},{"path":"/reference/mean_ligand_expression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate mean ligand expression as a data.frame for plotting in circos plot — mean_ligand_expression","text":"data frame ligand expression targeting specified receptor","code":""},{"path":"/reference/rename_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Renames clusters in a domino object — rename_clusters","title":"Renames clusters in a domino object — rename_clusters","text":"function reads receptor ligand signaling database, cell level  features kind (ie. output pySCENIC), z-scored single cell data,  cluster id single cell data, calculates correlation matrix  receptors features (transcription factor module scores  using pySCENIC), finds features enriched cluster. return  domino object prepared build_domino, calculate signaling  network.","code":""},{"path":"/reference/rename_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Renames clusters in a domino object — rename_clusters","text":"","code":"rename_clusters(dom, clust_conv)"},{"path":"/reference/rename_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Renames clusters in a domino object — rename_clusters","text":"dom domino object rename clusters clust_conv named vector conversions old new clusters. Values taken new clusters IDs names old cluster IDs.","code":""},{"path":"/reference/rename_clusters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Renames clusters in a domino object — rename_clusters","text":"domino object clusters renamed applicable slots.","code":""},{"path":"/reference/signaling_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a network heatmap — signaling_heatmap","title":"Create a network heatmap — signaling_heatmap","text":"Creates heatmap signaling network. Alternatively, network  matrix can accessed directly signaling slot domino object.","code":""},{"path":"/reference/signaling_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a network heatmap — signaling_heatmap","text":"","code":"signaling_heatmap(   dom,   clusts = NULL,   min_thresh = -Inf,   max_thresh = Inf,   scale = \"none\",   normalize = \"none\",   ... )"},{"path":"/reference/signaling_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a network heatmap — signaling_heatmap","text":"dom domino object network built (build_domino) clusts vector clusters included. NULL clusters used. min_thresh Minimum signaling threshold plotting. Defaults -Inf threshold. max_thresh Maximum signaling threshold plotting. Defaults Inf threshold. scale scale values (thresholding). Options 'none', 'sqrt' square root, 'log' log10. normalize Options normalize matrix. Normalization done thresholding scaling. Accepted inputs 'none' normalization, 'rec_norm' normalize maximum value receptor cluster, 'lig_norm' normalize maximum value within ligand cluster ... parameters pass NMF::aheatmap","code":""},{"path":"/reference/signaling_network.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a cluster to cluster signaling network diagram — signaling_network","title":"Create a cluster to cluster signaling network diagram — signaling_network","text":"Creates network diagram signaling clusters. Nodes clusters directed edges indicate signaling one cluster another. Edges colored based color scheme ligand expressing cluster.","code":""},{"path":"/reference/signaling_network.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a cluster to cluster signaling network diagram — signaling_network","text":"","code":"signaling_network(   dom,   cols = NULL,   edge_weight = 0.3,   clusts = NULL,   showOutgoingSignalingClusts = NULL,   showIncomingSignalingClusts = NULL,   min_thresh = -Inf,   max_thresh = Inf,   normalize = \"none\",   scale = \"sq\",   layout = \"circle\",   scale_by = \"rec_sig\",   vert_scale = 3,   plot_title = NULL,   ... )"},{"path":"/reference/signaling_network.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a cluster to cluster signaling network diagram — signaling_network","text":"dom domino object network built (build_domino) cols named vector indicating colors clusters. Values colors names must match clusters domino object. left NULL ggplot colors generated clusters. edge_weight Weight determining thickness edges plot. Signaling values multiplied value. clusts vector clusters included network plot. showOutgoingSignalingClusts vector clusters plot outgoing signaling showIncomingSignalingClusts vector clusters plot incoming signaling min_thresh Minimum signaling threshold. Values lower threshold set threshold. Defaults -Inf threshold. max_thresh Maximum signaling threshold plotting. Values higher threshold set threshold. Defaults Inf threshold. normalize Options normalize signaling matrix. Accepted inputs 'none' normalization, 'rec_norm' normalize maximum value receptor cluster, 'lig_norm' normalize maximum value within ligand cluster scale scale values (thresholding). Options 'none', 'sqrt' square root, 'log' log10, 'sq' square. layout Type layout use. Options 'random', 'sphere', 'circle', 'fr' Fruchterman-Reingold force directed layout, 'kk' Kamada Kawai directed layout. scale_by size vertices. Options 'lig_sig' summed outgoing signaling, 'rec_sig' summed incoming signaling, 'none'. former two cases values scaled asinh summing incoming outgoing signaling. vert_scale Integer used scale size vertices without variable scaling size_verts_by. ... parameters passed plot used igraph object.","code":""}]
